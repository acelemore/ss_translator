var xe=Object.defineProperty;var H=Object.getOwnPropertySymbols;var Ce=Object.prototype.hasOwnProperty,Te=Object.prototype.propertyIsEnumerable;var J=(v,i,s)=>i in v?xe(v,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):v[i]=s,O=(v,i)=>{for(var s in i||(i={}))Ce.call(i,s)&&J(v,s,i[s]);if(H)for(var s of H(i))Te.call(i,s)&&J(v,s,i[s]);return v};var U=(v,i,s)=>new Promise((w,g)=>{var C=f=>{try{V(s.next(f))}catch(b){g(b)}},F=f=>{try{V(s.throw(f))}catch(b){g(b)}},V=f=>f.done?w(f.value):Promise.resolve(f.value).then(C,F);V((s=s.apply(v,i)).next())});import{_ as Ue,u as Se,r as p,c as h,s as K,o as De,d as S,e as c,f as l,w as o,l as Fe,j as n,m as u,i as _,G as $e,F as Q,k as W,H as ze,g as D,t as E,h as X,I as x,E as m,b as Be}from"./index-wIxDU7xz.js";const Le={class:"terminology-view"},Ae={key:0,class:"empty-state"},Ee={key:1},Ie={class:"operations-bar"},Ne={class:"search-section"},Pe={class:"action-buttons"},he={class:"pagination-container"},je={key:0,class:"selected-file-info"},qe={__name:"TerminologyView",setup(v){const i=Se(),s=p([]),w=p(""),g=p(""),C=p(1),F=p(20),V=p(!1),f=p(!1),b=p(!1),y=p(null),T=p(!1),$=p(!1),z=p(null),r=p({term:"",translation:"",domain:"",notes:""}),j=p(),q=h(()=>{let t=s.value;if(w.value){const e=w.value.toLowerCase();t=t.filter(d=>d.term.toLowerCase().includes(e)||d.translation&&d.translation.toLowerCase().includes(e)||d.notes&&d.notes.toLowerCase().includes(e))}return g.value&&(t=t.filter(e=>e.domain===g.value)),t}),Y=h(()=>{const t=(C.value-1)*F.value,e=t+F.value;return q.value.slice(t,e)}),M=h(()=>{const t=new Set;return s.value.forEach(e=>{e.domain&&t.add(e.domain)}),Array.from(t).sort()}),B=()=>U(null,null,function*(){V.value=!0;try{const t=yield x.getTerminologyList();t.success?s.value=t.terms||[]:m.error(t.message||"加载术语列表失败")}catch(t){console.error("加载术语列表失败:",t),m.error("加载术语列表失败")}finally{V.value=!1}}),Z=t=>{z.value=t,r.value=O({},t),T.value=!0},ee=()=>U(null,null,function*(){try{if(yield j.value.validate(),f.value=!0,z.value)yield x.deleteTerminology(z.value.term),yield x.addTerminology(r.value.term,r.value.translation,r.value.domain||"general",r.value.notes||""),m.success("术语更新成功");else{const t=yield x.addTerminology(r.value.term,r.value.translation,r.value.domain||"general",r.value.notes||"");t.success?m.success("术语添加成功"):m.error(t.message||"术语添加失败")}T.value=!1,te(),yield B()}catch(t){console.error("保存术语失败:",t),m.error("保存失败")}finally{f.value=!1}}),le=t=>U(null,null,function*(){try{yield Be.confirm("确定要删除这个术语吗？","删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const e=yield x.deleteTerminology(t.term);e.success?(m.success("术语删除成功"),yield B()):m.error(e.message||"删除失败")}catch(e){e!=="cancel"&&(console.error("删除术语失败:",e),m.error("删除失败"))}}),te=()=>{r.value={term:"",translation:"",domain:"",notes:""},z.value=null},oe=()=>{$.value=!0},ae=()=>U(null,null,function*(){try{yield x.exportTerminology(),m.success("导出完成")}catch(t){console.error("导出失败:",t),m.error("导出失败")}}),ne=t=>{y.value=t.raw,m.success(`已选择文件: ${t.name}`)},se=()=>U(null,null,function*(){if(!y.value){m.warning("请先选择文件");return}try{b.value=!0;const t=yield x.importTerminology(y.value);t.success?(m.success(t.message),$.value=!1,y.value=null,yield B()):m.error(t.message||"导入失败")}catch(t){console.error("导入失败:",t),m.error("导入失败")}finally{b.value=!1}}),re=t=>t?new Date(t).toLocaleDateString():"-";return K(()=>i.isConfigSelected,t=>{t&&s.value.length===0&&B()}),K([w,g],()=>{C.value=1}),De(()=>{i.isConfigSelected&&B()}),(t,e)=>{const d=n("el-button"),ue=n("el-empty"),ie=n("Search"),L=n("el-icon"),I=n("el-input"),P=n("el-option"),R=n("el-select"),de=n("Plus"),me=n("Upload"),pe=n("Download"),A=n("el-text"),k=n("el-table-column"),ce=n("el-tag"),fe=n("el-table"),ve=n("el-pagination"),N=n("el-form-item"),_e=n("el-form"),G=n("el-dialog"),ge=n("upload-filled"),ye=n("el-upload"),we=n("el-alert"),Ve=n("el-card"),be=ze("loading");return c(),S("div",Le,[l(Ve,{class:"header-card"},{header:o(()=>e[13]||(e[13]=[_("div",{class:"card-header"},[_("span",null,"📚 专有名词管理"),_("p",null,"管理翻译中的专业术语和固定译名")],-1)])),default:o(()=>[Fe(i).isConfigSelected?(c(),S("div",Ee,[_("div",Ie,[_("div",Ne,[l(I,{modelValue:w.value,"onUpdate:modelValue":e[1]||(e[1]=a=>w.value=a),placeholder:"搜索术语或译名...",style:{width:"300px"},clearable:""},{prefix:o(()=>[l(L,null,{default:o(()=>[l(ie)]),_:1})]),_:1},8,["modelValue"]),l(R,{modelValue:g.value,"onUpdate:modelValue":e[2]||(e[2]=a=>g.value=a),style:{width:"150px","margin-left":"12px"}},{default:o(()=>[l(P,{label:"全部分类",value:""}),(c(!0),S(Q,null,W(M.value,a=>(c(),D(P,{key:a,label:a,value:a},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_("div",Pe,[l(d,{type:"primary",onClick:e[3]||(e[3]=a=>T.value=!0)},{default:o(()=>[l(L,null,{default:o(()=>[l(de)]),_:1}),e[15]||(e[15]=u(" 添加术语 "))]),_:1,__:[15]}),l(d,{onClick:oe},{default:o(()=>[l(L,null,{default:o(()=>[l(me)]),_:1}),e[16]||(e[16]=u(" 导入 "))]),_:1,__:[16]}),l(d,{onClick:ae},{default:o(()=>[l(L,null,{default:o(()=>[l(pe)]),_:1}),e[17]||(e[17]=u(" 导出 "))]),_:1,__:[17]})])]),$e((c(),D(fe,{data:Y.value,style:{width:"100%"},stripe:""},{default:o(()=>[l(k,{prop:"term",label:"原术语","min-width":"150"},{default:o(a=>[l(A,{type:"primary"},{default:o(()=>[u(E(a.row.term),1)]),_:2},1024)]),_:1}),l(k,{prop:"translation",label:"译名","min-width":"150"},{default:o(a=>[a.row.translation?(c(),D(A,{key:0,type:"primary"},{default:o(()=>[u(E(a.row.translation),1)]),_:2},1024)):(c(),D(A,{key:1,type:"info"},{default:o(()=>e[18]||(e[18]=[u("未翻译")])),_:1,__:[18]}))]),_:1}),l(k,{prop:"domain",label:"分类",width:"120"},{default:o(a=>[a.row.domain?(c(),D(ce,{key:0,size:"small"},{default:o(()=>[u(E(a.row.domain),1)]),_:2},1024)):X("",!0)]),_:1}),l(k,{prop:"notes",label:"说明","min-width":"200","show-overflow-tooltip":""}),l(k,{prop:"frequency",label:"使用频率",width:"100",sortable:""},{default:o(a=>[l(A,null,{default:o(()=>[u(E(a.row.frequency||0),1)]),_:2},1024)]),_:1}),l(k,{prop:"lastUsed",label:"最后使用",width:"120"},{default:o(a=>[l(A,{type:"info",size:"small"},{default:o(()=>[u(E(re(a.row.lastUsed)),1)]),_:2},1024)]),_:1}),l(k,{label:"操作",width:"150",fixed:"right"},{default:o(a=>[l(d,{type:"primary",size:"small",onClick:ke=>Z(a.row)},{default:o(()=>e[19]||(e[19]=[u(" 编辑 ")])),_:2,__:[19]},1032,["onClick"]),l(d,{type:"danger",size:"small",onClick:ke=>le(a.row)},{default:o(()=>e[20]||(e[20]=[u(" 删除 ")])),_:2,__:[20]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[be,V.value]]),_("div",he,[l(ve,{modelValue:C.value,"onUpdate:modelValue":e[4]||(e[4]=a=>C.value=a),"page-size":F.value,total:q.value.length,layout:"prev, pager, next, jumper, total"},null,8,["modelValue","page-size","total"])]),l(G,{modelValue:T.value,"onUpdate:modelValue":e[10]||(e[10]=a=>T.value=a),title:z.value?"编辑术语":"添加术语",width:"600px"},{footer:o(()=>[l(d,{onClick:e[9]||(e[9]=a=>T.value=!1)},{default:o(()=>e[21]||(e[21]=[u("取消")])),_:1,__:[21]}),l(d,{type:"primary",onClick:ee,loading:f.value},{default:o(()=>e[22]||(e[22]=[u("确定")])),_:1,__:[22]},8,["loading"])]),default:o(()=>[l(_e,{model:r.value,"label-width":"80px",ref_key:"termFormRef",ref:j},{default:o(()=>[l(N,{label:"原术语",prop:"term",rules:[{required:!0,message:"请输入原术语"}]},{default:o(()=>[l(I,{modelValue:r.value.term,"onUpdate:modelValue":e[5]||(e[5]=a=>r.value.term=a),placeholder:"请输入原术语"},null,8,["modelValue"])]),_:1}),l(N,{label:"译名",prop:"translation"},{default:o(()=>[l(I,{modelValue:r.value.translation,"onUpdate:modelValue":e[6]||(e[6]=a=>r.value.translation=a),placeholder:"请输入译名"},null,8,["modelValue"])]),_:1}),l(N,{label:"分类",prop:"domain"},{default:o(()=>[l(R,{modelValue:r.value.domain,"onUpdate:modelValue":e[7]||(e[7]=a=>r.value.domain=a),placeholder:"选择或输入分类",filterable:"","allow-create":""},{default:o(()=>[(c(!0),S(Q,null,W(M.value,a=>(c(),D(P,{key:a,label:a,value:a},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(N,{label:"说明",prop:"notes"},{default:o(()=>[l(I,{modelValue:r.value.notes,"onUpdate:modelValue":e[8]||(e[8]=a=>r.value.notes=a),type:"textarea",rows:3,placeholder:"术语说明或使用场景"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),l(G,{modelValue:$.value,"onUpdate:modelValue":e[12]||(e[12]=a=>$.value=a),title:"导入术语",width:"500px"},{footer:o(()=>[l(d,{onClick:e[11]||(e[11]=a=>{$.value=!1,y.value=null})},{default:o(()=>e[25]||(e[25]=[u("取消")])),_:1,__:[25]}),l(d,{type:"primary",onClick:se,loading:b.value,disabled:!y.value},{default:o(()=>e[26]||(e[26]=[u(" 导入 ")])),_:1,__:[26]},8,["loading","disabled"])]),default:o(()=>[l(ye,{ref:"uploadRef","auto-upload":!1,"on-change":ne,"show-file-list":!1,accept:".json",drag:""},{tip:o(()=>e[23]||(e[23]=[_("div",{class:"el-upload__tip"}," 只支持 JSON 格式文件 ",-1)])),default:o(()=>[l(L,{class:"el-icon--upload"},{default:o(()=>[l(ge)]),_:1}),e[24]||(e[24]=_("div",{class:"el-upload__text"},[u(" 将文件拖到此处，或"),_("em",null,"点击上传")],-1))]),_:1,__:[24]},512),y.value?(c(),S("div",je,[l(we,{title:`已选择文件: ${y.value.name}`,type:"success",closable:!1,"show-icon":""},null,8,["title"])])):X("",!0)]),_:1},8,["modelValue"])])):(c(),S("div",Ae,[l(ue,{description:"请先选择配置"},{default:o(()=>[l(d,{type:"primary",onClick:e[0]||(e[0]=a=>t.$router.push("/"))},{default:o(()=>e[14]||(e[14]=[u(" 去配置管理 ")])),_:1,__:[14]})]),_:1})]))]),_:1})])}}},Ge=Ue(qe,[["__scopeId","data-v-dd725629"]]);export{Ge as default};
