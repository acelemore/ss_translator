var Ll=Object.defineProperty,Sl=Object.defineProperties;var Ol=Object.getOwnPropertyDescriptors;var ze=Object.getOwnPropertySymbols;var Rl=Object.prototype.hasOwnProperty,Pl=Object.prototype.propertyIsEnumerable;var He=(g,p,v)=>p in g?Ll(g,p,{enumerable:!0,configurable:!0,writable:!0,value:v}):g[p]=v,ee=(g,p)=>{for(var v in p||(p={}))Rl.call(p,v)&&He(g,v,p[v]);if(ze)for(var v of ze(p))Pl.call(p,v)&&He(g,v,p[v]);return g},$e=(g,p)=>Sl(g,Ol(p));var _=(g,p,v)=>new Promise((E,D)=>{var J=$=>{try{P(v.next($))}catch(z){D(z)}},A=$=>{try{P(v.throw($))}catch(z){D(z)}},P=$=>$.done?E($.value):Promise.resolve($.value).then(J,A);P((v=v.apply(g,p)).next())});import{r as f,_ as El,u as Tl,c as le,E as s,a as q,b as de,o as Bl,d as B,e as c,f as l,g as U,h as fe,w as t,i as n,j as w,F as te,k as ae,l as C,m as r,t as j,n as me,p as Dl,q as Me}from"./index-B0OZ2IFU.js";function Ie(){const g=f(new Map);return{createLoadingHandler:(J,A="default")=>{g.value.has(A)||g.value.set(A,!1);const P=f(!1),$=T=>{P.value=T,g.value.set(A,T)};return{handler:(...T)=>_(null,null,function*(){if(!g.value.get(A))try{return $(!0),yield J(...T)}catch(H){throw H}finally{$(!1)}}),loading:P,isLoading:()=>g.value.get(A)||!1}},getLoadingState:(J="default")=>g.value.get(J)||!1,clearLoading:(J="default")=>{g.value.set(J,!1)},clearAllLoading:()=>{for(const[J]of g.value)g.value.set(J,!1)},loadingStates:g}}Ie();const hl={class:"config-view"},ql={class:"config-selector"},zl={style:{display:"flex","justify-content":"space-between","align-items":"center"}},Hl={class:"empty-state"},Ml={class:"empty-state"},Il={style:{display:"flex","justify-content":"space-between","align-items":"center"}},Gl={class:"file-config-section"},Kl={class:"section-header"},Ql={class:"config-count"},Wl={key:1,class:"empty-state"},Xl={class:"file-config-section"},Yl={class:"section-header"},Zl={class:"config-count"},et={key:1,class:"empty-state"},lt={class:"file-config-section"},tt={class:"section-header"},at={class:"config-count"},ot={style:{"font-size":"12px",color:"var(--el-text-color-secondary)"}},nt={key:1,class:"empty-state"},st={class:"field-config-list"},rt={__name:"ConfigView",setup(g){const p=Tl(),{createLoadingHandler:v}=Ie(),E=f(""),D=f(!1),J=f(!1),A=f(!1),P=f(!1),$=f(),z=f(null),T=f(),H=f(),pe=f(),Le=f("csv"),_e=f({}),y=f({csv_files:{},json_files:{},jar_files:{}}),ye=f(!1),we=f(!1),Ce=f(!1),be=f(!1),oe=f(!1),M=f(!1),L=f({path:"",fields:[{name:"",function:""}]}),Ge={path:[{required:!0,message:"请输入文件路径",trigger:"blur"},{pattern:/^\.\/.*\.csv$/i,message:'文件路径必须以"./"开头且以".csv"结尾',trigger:"blur"}],fields:[{validator:(a,e,u)=>{if(!e||e.length===0){u(new Error("至少需要配置一个字段"));return}const k=e.filter(K=>K.name.trim()&&K.function);if(k.length===0){u(new Error("至少需要配置一个完整的字段"));return}const ie=k.map(K=>K.name.trim()),d=[...new Set(ie)];if(ie.length!==d.length){u(new Error("字段名不能重复"));return}u()},trigger:"change"}]},Ke={path:[{required:!0,message:"请输入文件路径",trigger:"blur"},{pattern:/^\.\/.*\.json$/i,message:'文件路径必须以"./"开头且以".json"结尾',trigger:"blur"}],extract_function:[{required:!0,message:"请选择处理函数",trigger:"change"}]},Qe={path:[{required:!0,message:"请输入文件路径",trigger:"blur"},{pattern:/^\.\/.*\.jar$/i,message:'文件路径必须以"./"开头且以".jar"结尾',trigger:"blur"}],extract_function:[{required:!0,message:"请选择处理函数",trigger:"change"}]},ne=f(!1),I=f(!1),S=f({path:"",extract_function:"",description:""}),se=f(!1),G=f(!1),V=f({path:"",extract_function:"jar_extract",description:"",backup_suffix:".backup",output_suffix:"_translated.jar"}),F=f({configName:"",modName:"",modPath:"",description:"",temperature:.1,max_tokens:2e3}),N=f({configName:"",modName:"",modPath:"",description:"",temperature:.1,max_tokens:2e3}),O=f({api_key:"",base_url:"https://api.openai.com/v1",model:"gpt-3.5-turbo",max_tokens:2e3,temperature:.1}),ve=f(null),Ve=le(()=>p.configs),i=le(()=>p.currentConfig),xe=le(()=>{const a={};return Object.entries(_e.value).forEach(([e,u])=>{typeof u=="string"?a[e]=u:typeof u=="object"&&u.description&&(a[e]=u.description)}),a}),ke=a=>{const e={};return Object.entries(_e.value).forEach(([u,k])=>{typeof k=="string"?e[u]=k:typeof k=="object"&&k.description&&(k.file_type===a||!k.file_type)&&(e[u]=k.description)}),e},je=le(()=>Object.entries(y.value.csv_files||{}).map(([a,e])=>({path:a,fields:e}))),Fe=le(()=>Object.entries(y.value.json_files||{}).map(([a,e])=>ee({path:a},e))),Ne=le(()=>Object.entries(y.value.jar_files||{}).map(([a,e])=>ee({path:a},e))),ce=()=>_(null,null,function*(){try{yield p.loadConfigs()}catch(a){s.error("加载配置失败")}}),{handler:We,loading:Xe}=v(()=>_(null,null,function*(){const a=F.value;if(!a.configName||!a.modName||!a.modPath){s.warning("请填写必填项");return}try{const e=yield q.createConfig(a.configName,a.modName,a.modPath,a.description,a.temperature,a.max_tokens);if(e.success){s.success("配置创建成功"),D.value=!1;const u=a.configName;F.value={configName:"",modName:"",modPath:"",description:"",temperature:.1,max_tokens:2e3},yield ce(),E.value=u,yield qe(u)}else s.error(e.message)}catch(e){s.error("创建配置失败")}}),"createConfig"),{handler:Ye,loading:Ze}=v(()=>_(null,null,function*(){if(i.value)try{yield de.confirm("确定要删除当前配置吗？此操作不可撤销。","警告",{type:"warning"});const a=yield q.deleteConfig(i.value.name);a.success?(s.success("配置删除成功"),p.clearCurrentConfig(),E.value="",yield ce()):s.error(a.message)}catch(a){a!=="cancel"&&s.error("删除配置失败")}}),"deleteConfig"),{handler:el,loading:ll}=v(()=>_(null,null,function*(){if(i.value)try{const a=yield q.exportConfig(i.value.name),e=window.URL.createObjectURL(a),u=document.createElement("a");u.href=e,u.download=`${i.value.name}_export.json`,u.click(),window.URL.revokeObjectURL(e),s.success("配置导出成功")}catch(a){s.error("导出配置失败")}}),"exportConfig"),{handler:tl,loading:al}=v(()=>_(null,null,function*(){if(!i.value){s.warning("请先选择一个配置");return}try{yield de.confirm("该操作会完全覆盖现有配置，是否继续？","自动配置确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const a=i.value.filename||i.value.name,e=yield q.autoDetectFiles(a);if(e.success){s.success(e.message),yield p.selectConfig(a),yield re();try{yield Se(),s.success("自动配置已保存")}catch(u){s.warning("自动配置完成，但保存失败，请手动保存"),console.error("自动保存失败:",u)}}else s.error(e.message)}catch(a){a!=="cancel"&&s.error("自动配置失败")}}),"autoConfig"),{handler:ol,loading:nl}=v(()=>_(null,null,function*(){var e;if(!z.value){s.warning("请选择文件");return}const a=new FormData;a.append("config_file",z.value);try{const u=yield q.importConfig(a);u.success?(s.success(u.message),P.value=!1,z.value=null,(e=$.value)==null||e.clearFiles(),yield ce()):s.error(u.message)}catch(u){s.error("导入配置失败")}}),"importConfig"),{handler:sl,loading:rl}=v(()=>_(null,null,function*(){try{const a=yield q.saveGlobalConfig(O.value);a.success?(s.success("API配置保存成功"),J.value=!1,yield he()):s.error(a.message)}catch(a){s.error("保存API配置失败")}}),"saveApiConfig"),{handler:il,loading:ul}=v(()=>_(null,null,function*(){const a=N.value;if(!a.configName||!a.modName||!a.modPath){s.warning("请填写必填项");return}try{const e=$e(ee({},i.value),{config_name:a.modName,mod_path:a.modPath,description:a.description,temperature:a.temperature,max_tokens:a.max_tokens}),u=yield q.saveConfig(i.value.name,e);u.success?(s.success("配置更新成功"),A.value=!1,yield p.selectConfig(i.value.name),yield re(),De()):s.error(u.message||"更新配置失败")}catch(e){console.error("更新配置失败:",e),s.error("更新配置失败")}}),"saveEditConfig"),dl=()=>_(null,null,function*(){try{const a=yield Dl.getExtractFunctions();_e.value=a}catch(a){console.error("加载提取函数失败:",a)}}),re=()=>_(null,null,function*(){if(i.value)try{y.value={csv_files:i.value.csv_files||{},json_files:i.value.json_files||{},jar_files:i.value.jar_files||{}}}catch(a){console.error("加载配置内容失败:",a)}}),{handler:Se,loading:fl}=v(()=>_(null,null,function*(){if(i.value)try{if(Object.keys(y.value.csv_files).length+Object.keys(y.value.json_files).length+Object.keys(y.value.jar_files).length===0){s.warning("请至少配置一个翻译文件");return}const e=$e(ee({},i.value),{csv_files:y.value.csv_files,json_files:y.value.json_files,jar_files:y.value.jar_files}),u=yield q.saveConfig(i.value.name,e);if(u.success){s.success("配置保存成功");const k=i.value.filename||i.value.name;yield p.selectConfig(k),yield re()}else s.error(u.message||"保存配置失败")}catch(a){console.error("保存配置失败:",a),s.error("保存配置失败")}}),"saveConfigContent"),ml=()=>{L.value.fields.push({name:"",function:""})},pl=a=>{L.value.fields.length>1&&(L.value.fields.splice(a,1),Me(()=>{var e;(e=T.value)==null||e.validateField("fields")}))},vl=(a,e)=>{a.name.trim()&&Me(()=>{var u;(u=T.value)==null||u.validateField("fields")})},cl=a=>{M.value=!0,L.value={path:a.path,fields:Object.entries(a.fields).map(([e,u])=>({name:e,function:u}))},oe.value=!0},gl=a=>_(null,null,function*(){try{yield de.confirm("确定要删除这个CSV文件配置吗？","删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),delete y.value.csv_files[a],s.success("CSV文件配置删除成功")}catch(e){}}),_l=()=>_(null,null,function*(){if(T.value){try{yield T.value.validate()}catch(a){return}ye.value=!0;try{if(!M.value&&y.value.csv_files[L.value.path]){s.error("该文件路径已存在");return}const a={};for(const e of L.value.fields)e.name.trim()&&e.function&&(a[e.name.trim()]=e.function);y.value.csv_files[L.value.path]=a,s.success(`CSV文件配置${M.value?"更新":"添加"}成功`),setTimeout(()=>{(Object.keys(y.value.csv_files).length>0||Object.keys(y.value.json_files).length>0||Object.keys(y.value.jar_files).length>0)&&s({message:'别忘了点击"保存配置"按钮保存到后端！',type:"warning",duration:3e3})},1e3),Oe()}catch(a){s.error(`${M.value?"更新":"添加"}CSV文件配置失败`)}finally{ye.value=!1}}}),Oe=()=>{var a;oe.value=!1,M.value=!1,L.value={path:"",fields:[{name:"",function:""}]},(a=T.value)==null||a.clearValidate()},Re=()=>{Oe()},yl=a=>{I.value=!0,S.value={path:a.path,extract_function:a.extract_function,description:a.description||""},ne.value=!0},wl=a=>_(null,null,function*(){try{yield de.confirm("确定要删除这个JSON文件配置吗？","删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),delete y.value.json_files[a],s.success("JSON文件配置删除成功")}catch(e){}}),Cl=()=>_(null,null,function*(){if(H.value){try{yield H.value.validate()}catch(a){return}we.value=!0;try{if(!I.value&&y.value.json_files[S.value.path]){s.error("该文件路径已存在");return}y.value.json_files[S.value.path]={extract_function:S.value.extract_function,description:S.value.description},s.success(`JSON文件配置${I.value?"更新":"添加"}成功`),setTimeout(()=>{s({message:'别忘了点击"保存配置"按钮保存到后端！',type:"warning",duration:3e3})},1e3),Pe()}catch(a){s.error(`${I.value?"更新":"添加"}JSON文件配置失败`)}finally{we.value=!1}}}),Pe=()=>{var a;ne.value=!1,I.value=!1,S.value={path:"",extract_function:"",description:""},(a=H.value)==null||a.clearValidate()},Ee=()=>{Pe()},bl=a=>{G.value=!0,V.value={path:a.path,extract_function:a.extract_function||"jar_extract",description:a.description||"",backup_suffix:a.backup_suffix||".backup",output_suffix:a.output_suffix||"_translated.jar"},se.value=!0},Vl=a=>_(null,null,function*(){try{yield de.confirm("确定要删除这个JAR文件配置吗？","删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),delete y.value.jar_files[a],s.success("JAR文件配置删除成功")}catch(e){}}),xl=()=>_(null,null,function*(){if(pe.value){try{yield pe.value.validate()}catch(a){return}Ce.value=!0;try{if(!G.value&&y.value.jar_files[V.value.path]){s.error("该文件路径已存在");return}y.value.jar_files[V.value.path]={extract_function:V.value.extract_function||"jar_extract",description:V.value.description,backup_suffix:V.value.backup_suffix||".backup",output_suffix:V.value.output_suffix||"_translated.jar"},s.success(`JAR文件配置${G.value?"更新":"添加"}成功`),setTimeout(()=>{s({message:'别忘了点击"保存配置"按钮保存到后端！',type:"warning",duration:3e3})},1e3),Te()}catch(a){s.error(`${G.value?"更新":"添加"}JAR文件配置失败`)}finally{Ce.value=!1}}}),Te=()=>{var a;se.value=!1,G.value=!1,V.value={path:"",extract_function:"jar_extract",description:"",backup_suffix:".backup",output_suffix:"_translated.jar"},(a=pe.value)==null||a.clearValidate()},Be=()=>{Te()},kl=a=>{z.value=a.raw},De=()=>{N.value={configName:"",modName:"",modPath:"",description:"",temperature:.1,max_tokens:2e3}},jl=()=>{i.value&&(N.value={configName:i.value.name||"",modName:i.value.config_name||i.value.mod_name||"",modPath:i.value.mod_path||"",description:i.value.description||"",temperature:i.value.temperature||.1,max_tokens:i.value.max_tokens||2e3})},Fl=()=>_(null,null,function*(){try{const a=yield q.getGlobalConfig();a.success&&(O.value=ee({},a.config))}catch(a){console.error("加载API配置失败:",a)}}),he=()=>_(null,null,function*(){try{const a=yield q.checkApiConfig();a.success&&(ve.value=a)}catch(a){console.error("检查API状态失败:",a)}}),qe=a=>_(null,null,function*(){if(a==="__create_new__"){E.value="",D.value=!0;return}if(a&&a!=="__create_new__"){be.value=!0;try{const e=yield p.selectConfig(a);e.success?(s.success(e.message),yield re()):(s.error(e.message),E.value="")}catch(e){s.error("选择配置失败"),E.value=""}finally{be.value=!1}}});return Bl(()=>_(null,null,function*(){try{yield Promise.all([ce(),dl(),Fl(),he()]),yield p.getCurrentConfig(),i.value&&(E.value=i.value.filename||i.value.name,yield re())}catch(a){console.error("初始化失败:",a),s.error("页面初始化失败，请刷新重试")}})),(a,e)=>{const u=w("el-option"),k=w("el-select"),ie=w("el-col"),d=w("el-button"),K=w("el-space"),Nl=w("el-row"),X=w("el-card"),Q=w("el-descriptions-item"),Jl=w("el-descriptions"),ue=w("el-icon"),R=w("el-table-column"),ge=w("el-tag"),Je=w("el-table"),Ue=w("el-tab-pane"),Ul=w("el-tabs"),Al=w("el-alert"),x=w("el-input"),m=w("el-form-item"),Y=w("el-input-number"),Z=w("el-form"),W=w("el-dialog"),$l=w("el-upload");return c(),B("div",hl,[l(X,{class:"header-card"},{header:t(()=>e[46]||(e[46]=[n("div",{class:"card-header"},[n("span",null,"⚙️ 配置管理"),n("p",null,"选择或创建翻译配置文件")],-1)])),default:t(()=>[n("div",ql,[l(Nl,{gutter:16,align:"middle"},{default:t(()=>[l(ie,{span:12},{default:t(()=>[l(k,{modelValue:E.value,"onUpdate:modelValue":e[0]||(e[0]=o=>E.value=o),placeholder:"请选择配置...",style:{width:"100%"},onChange:qe,loading:be.value},{default:t(()=>[l(u,{key:"create-new",label:"+ 创建新配置",value:"__create_new__"}),(c(!0),B(te,null,ae(Ve.value,o=>(c(),U(u,{key:o.filename,label:`${o.name} (${o.filename})`,value:o.filename},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])]),_:1}),i.value?(c(),U(ie,{key:0,span:12},{default:t(()=>[l(K,null,{default:t(()=>[l(d,{type:"info",onClick:C(el),loading:C(ll)},{default:t(()=>e[47]||(e[47]=[r(" 导出配置 ")])),_:1,__:[47]},8,["onClick","loading"]),l(d,{type:"info",onClick:e[1]||(e[1]=o=>P.value=!0)},{default:t(()=>e[48]||(e[48]=[r(" 导入配置 ")])),_:1,__:[48]}),l(d,{type:"danger",onClick:C(Ye),loading:C(Ze)},{default:t(()=>e[49]||(e[49]=[r(" 删除配置 ")])),_:1,__:[49]},8,["onClick","loading"])]),_:1})]),_:1})):fe("",!0)]),_:1})])]),_:1}),i.value?(c(),U(X,{key:0,class:"config-info-card"},{header:t(()=>[n("div",zl,[e[51]||(e[51]=n("span",null,"📋 当前配置信息",-1)),l(d,{type:"primary",size:"small",onClick:e[2]||(e[2]=o=>{jl(),A.value=!0})},{default:t(()=>e[50]||(e[50]=[r(" 编辑配置 ")])),_:1,__:[50]})])]),default:t(()=>[l(Jl,{column:2,border:""},{default:t(()=>[l(Q,{label:"配置名称"},{default:t(()=>[r(j(i.value.name),1)]),_:1}),l(Q,{label:"模组名称"},{default:t(()=>[r(j(i.value.config_name||i.value.mod_name||"未设置"),1)]),_:1}),l(Q,{label:"模组路径"},{default:t(()=>[r(j(i.value.mod_path||"未设置"),1)]),_:1}),l(Q,{label:"工作目录"},{default:t(()=>[r(j(i.value.work_directory||"未设置"),1)]),_:1}),l(Q,{label:"Temperature"},{default:t(()=>[r(j(i.value.temperature||"0.1"),1)]),_:1}),l(Q,{label:"最大令牌数"},{default:t(()=>[r(j(i.value.max_tokens||"2000"),1)]),_:1}),l(Q,{label:"描述",span:2},{default:t(()=>[r(j(i.value.description||"无描述"),1)]),_:1})]),_:1})]),_:1})):fe("",!0),!i.value&&Ve.value.length===0?(c(),U(X,{key:1,class:"empty-config-card"},{default:t(()=>[n("div",Hl,[l(ue,null,{default:t(()=>[l(C(me))]),_:1}),e[53]||(e[53]=n("h3",null,"暂无配置文件",-1)),e[54]||(e[54]=n("p",null,"请先创建一个翻译配置文件开始使用",-1)),l(d,{type:"primary",onClick:e[3]||(e[3]=o=>D.value=!0),size:"large"},{default:t(()=>e[52]||(e[52]=[r(" 创建新配置 ")])),_:1,__:[52]})])]),_:1})):!i.value&&Ve.value.length>0?(c(),U(X,{key:2,class:"empty-config-card"},{default:t(()=>[n("div",Ml,[l(ue,null,{default:t(()=>[l(C(me))]),_:1}),e[55]||(e[55]=n("h3",null,"请选择一个配置文件",-1)),e[56]||(e[56]=n("p",null,"从上方下拉菜单中选择一个已有的配置文件",-1))])]),_:1})):fe("",!0),i.value?(c(),U(X,{key:3,class:"config-edit-card"},{header:t(()=>[n("div",Il,[e[59]||(e[59]=n("span",null,"📝 编辑配置文件",-1)),l(K,null,{default:t(()=>[l(d,{type:"warning",onClick:C(tl),loading:C(al)},{default:t(()=>e[57]||(e[57]=[r(" 自动配置 ")])),_:1,__:[57]},8,["onClick","loading"]),l(d,{type:"primary",onClick:C(Se),loading:C(fl)},{default:t(()=>e[58]||(e[58]=[r(" 保存配置 ")])),_:1,__:[58]},8,["onClick","loading"])]),_:1})])]),default:t(()=>[l(Ul,{modelValue:Le.value,"onUpdate:modelValue":e[7]||(e[7]=o=>Le.value=o)},{default:t(()=>[l(Ue,{label:"CSV文件",name:"csv"},{default:t(()=>[n("div",Gl,[n("div",Kl,[n("h4",null,[e[60]||(e[60]=r("CSV文件配置 ")),n("span",Ql,"("+j(je.value.length)+" 个文件)",1)]),l(d,{type:"primary",onClick:e[4]||(e[4]=o=>oe.value=!0)},{default:t(()=>e[61]||(e[61]=[r(" 添加CSV文件 ")])),_:1,__:[61]})]),je.value.length>0?(c(),U(Je,{key:0,data:je.value,stripe:""},{default:t(()=>[l(R,{prop:"path",label:"文件路径","min-width":"200","show-overflow-tooltip":""}),l(R,{label:"字段数量",width:"100"},{default:t(o=>[l(ge,{type:"info",size:"small"},{default:t(()=>[r(j(Object.keys(o.row.fields).length)+" 个字段 ",1)]),_:2},1024)]),_:1}),l(R,{label:"配置字段","min-width":"300"},{default:t(o=>[(c(!0),B(te,null,ae(o.row.fields,(b,h)=>(c(),U(ge,{key:h,type:"info",size:"small"},{default:t(()=>[r(j(h)+": "+j(xe.value[b]||b),1)]),_:2},1024))),128))]),_:1}),l(R,{label:"操作",width:"150",fixed:"right"},{default:t(o=>[l(d,{size:"small",onClick:b=>cl(o.row)},{default:t(()=>e[62]||(e[62]=[r("编辑")])),_:2,__:[62]},1032,["onClick"]),l(d,{size:"small",type:"danger",onClick:b=>gl(o.row.path)},{default:t(()=>e[63]||(e[63]=[r("删除")])),_:2,__:[63]},1032,["onClick"])]),_:1})]),_:1},8,["data"])):(c(),B("div",Wl,[l(ue,null,{default:t(()=>[l(C(me))]),_:1}),e[64]||(e[64]=n("p",null,"暂未配置CSV文件",-1)),e[65]||(e[65]=n("p",null,'点击"添加CSV文件"按钮开始配置',-1))]))])]),_:1}),l(Ue,{label:"JSON文件",name:"json"},{default:t(()=>[n("div",Xl,[n("div",Yl,[n("h4",null,[e[66]||(e[66]=r("JSON文件配置 ")),n("span",Zl,"("+j(Fe.value.length)+" 个文件)",1)]),l(d,{type:"primary",onClick:e[5]||(e[5]=o=>ne.value=!0)},{default:t(()=>e[67]||(e[67]=[r(" 添加JSON文件 ")])),_:1,__:[67]})]),Fe.value.length>0?(c(),U(Je,{key:0,data:Fe.value,stripe:""},{default:t(()=>[l(R,{prop:"path",label:"文件路径","min-width":"200","show-overflow-tooltip":""}),l(R,{label:"处理函数",width:"200"},{default:t(o=>[l(ge,{type:"success"},{default:t(()=>[r(j(xe.value[o.row.extract_function]||o.row.extract_function),1)]),_:2},1024)]),_:1}),l(R,{prop:"description",label:"描述","show-overflow-tooltip":""}),l(R,{label:"操作",width:"150",fixed:"right"},{default:t(o=>[l(d,{size:"small",onClick:b=>yl(o.row)},{default:t(()=>e[68]||(e[68]=[r("编辑")])),_:2,__:[68]},1032,["onClick"]),l(d,{size:"small",type:"danger",onClick:b=>wl(o.row.path)},{default:t(()=>e[69]||(e[69]=[r("删除")])),_:2,__:[69]},1032,["onClick"])]),_:1})]),_:1},8,["data"])):(c(),B("div",et,[l(ue,null,{default:t(()=>[l(C(me))]),_:1}),e[70]||(e[70]=n("p",null,"暂未配置JSON文件",-1)),e[71]||(e[71]=n("p",null,'点击"添加JSON文件"按钮开始配置',-1))]))])]),_:1}),l(Ue,{label:"JAR文件",name:"jar"},{default:t(()=>[n("div",lt,[n("div",tt,[n("h4",null,[e[72]||(e[72]=r("JAR文件配置 ")),n("span",at,"("+j(Ne.value.length)+" 个文件)",1)]),l(d,{type:"primary",onClick:e[6]||(e[6]=o=>se.value=!0)},{default:t(()=>e[73]||(e[73]=[r(" 添加JAR文件 ")])),_:1,__:[73]})]),Ne.value.length>0?(c(),U(Je,{key:0,data:Ne.value,stripe:""},{default:t(()=>[l(R,{prop:"path",label:"文件路径","min-width":"200","show-overflow-tooltip":""}),l(R,{label:"处理函数",width:"200"},{default:t(o=>[l(ge,{type:"success"},{default:t(()=>[r(j(xe.value[o.row.extract_function]||o.row.extract_function),1)]),_:2},1024)]),_:1}),l(R,{prop:"description",label:"描述","show-overflow-tooltip":""}),l(R,{label:"配置",width:"200"},{default:t(o=>[n("div",ot,[r(" 备份: "+j(o.row.backup_suffix||".backup"),1),e[74]||(e[74]=n("br",null,null,-1)),r(" 输出: "+j(o.row.output_suffix||"_translated.jar"),1)])]),_:1}),l(R,{label:"操作",width:"150",fixed:"right"},{default:t(o=>[l(d,{size:"small",onClick:b=>bl(o.row)},{default:t(()=>e[75]||(e[75]=[r("编辑")])),_:2,__:[75]},1032,["onClick"]),l(d,{size:"small",type:"danger",onClick:b=>Vl(o.row.path)},{default:t(()=>e[76]||(e[76]=[r("删除")])),_:2,__:[76]},1032,["onClick"])]),_:1})]),_:1},8,["data"])):(c(),B("div",nt,[l(ue,null,{default:t(()=>[l(C(me))]),_:1}),e[77]||(e[77]=n("p",null,"暂未配置JAR文件",-1)),e[78]||(e[78]=n("p",null,'点击"添加JAR文件"按钮开始配置',-1))]))])]),_:1})]),_:1},8,["modelValue"])]),_:1})):fe("",!0),l(X,{class:"api-status-card"},{header:t(()=>e[79]||(e[79]=[n("span",null,"🔑 API配置状态",-1)])),default:t(()=>[ve.value?(c(),U(Al,{key:0,title:ve.value.message,type:ve.value.is_valid?"success":"error",closable:!1,style:{"margin-bottom":"16px"}},null,8,["title","type"])):fe("",!0),l(d,{type:"primary",onClick:e[8]||(e[8]=o=>J.value=!0)},{default:t(()=>e[80]||(e[80]=[r(" 配置API设置 ")])),_:1,__:[80]})]),_:1}),l(W,{modelValue:D.value,"onUpdate:modelValue":e[16]||(e[16]=o=>D.value=o),title:"新建配置",width:"500px"},{footer:t(()=>[l(d,{onClick:e[15]||(e[15]=o=>{D.value=!1,F.value={configName:"",modName:"",modPath:"",description:"",temperature:.1,max_tokens:2e3}})},{default:t(()=>e[83]||(e[83]=[r("取消")])),_:1,__:[83]}),l(d,{type:"primary",onClick:C(We),loading:C(Xe)},{default:t(()=>e[84]||(e[84]=[r(" 创建 ")])),_:1,__:[84]},8,["onClick","loading"])]),default:t(()=>[l(Z,{model:F.value,"label-width":"100px"},{default:t(()=>[l(m,{label:"配置名称",required:""},{default:t(()=>[l(x,{modelValue:F.value.configName,"onUpdate:modelValue":e[9]||(e[9]=o=>F.value.configName=o),placeholder:"不含扩展名"},null,8,["modelValue"])]),_:1}),l(m,{label:"模组名称",required:""},{default:t(()=>[l(x,{modelValue:F.value.modName,"onUpdate:modelValue":e[10]||(e[10]=o=>F.value.modName=o)},null,8,["modelValue"])]),_:1}),l(m,{label:"模组路径",required:""},{default:t(()=>[l(x,{modelValue:F.value.modPath,"onUpdate:modelValue":e[11]||(e[11]=o=>F.value.modPath=o)},null,8,["modelValue"])]),_:1}),l(m,{label:"描述"},{default:t(()=>[l(x,{modelValue:F.value.description,"onUpdate:modelValue":e[12]||(e[12]=o=>F.value.description=o),type:"textarea"},null,8,["modelValue"])]),_:1}),l(m,{label:"Temperature"},{default:t(()=>[l(Y,{modelValue:F.value.temperature,"onUpdate:modelValue":e[13]||(e[13]=o=>F.value.temperature=o),min:0,max:2,step:.1,precision:1,placeholder:"0.1",style:{width:"100%"}},null,8,["modelValue"]),e[81]||(e[81]=n("div",{class:"form-tip"}," 控制翻译创造性，0.0-2.0之间，值越低翻译越保守，建议0.1-0.3 ",-1))]),_:1,__:[81]}),l(m,{label:"最大令牌数"},{default:t(()=>[l(Y,{modelValue:F.value.max_tokens,"onUpdate:modelValue":e[14]||(e[14]=o=>F.value.max_tokens=o),min:100,max:1e4,step:100,placeholder:"2000",style:{width:"100%"}},null,8,["modelValue"]),e[82]||(e[82]=n("div",{class:"form-tip"}," 控制LLM响应的最大长度，一般设置为1000-4000之间 ",-1))]),_:1,__:[82]})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(W,{modelValue:A.value,"onUpdate:modelValue":e[24]||(e[24]=o=>A.value=o),title:"编辑配置",width:"500px"},{footer:t(()=>[l(d,{onClick:e[23]||(e[23]=o=>{A.value=!1,De()})},{default:t(()=>e[88]||(e[88]=[r("取消")])),_:1,__:[88]}),l(d,{type:"primary",onClick:C(il),loading:C(ul)},{default:t(()=>e[89]||(e[89]=[r(" 保存 ")])),_:1,__:[89]},8,["onClick","loading"])]),default:t(()=>[l(Z,{model:N.value,"label-width":"100px"},{default:t(()=>[l(m,{label:"配置名称",required:""},{default:t(()=>[l(x,{modelValue:N.value.configName,"onUpdate:modelValue":e[17]||(e[17]=o=>N.value.configName=o),placeholder:"不含扩展名",disabled:""},null,8,["modelValue"]),e[85]||(e[85]=n("div",{class:"form-tip"},"配置名称不可修改",-1))]),_:1,__:[85]}),l(m,{label:"模组名称",required:""},{default:t(()=>[l(x,{modelValue:N.value.modName,"onUpdate:modelValue":e[18]||(e[18]=o=>N.value.modName=o)},null,8,["modelValue"])]),_:1}),l(m,{label:"模组路径",required:""},{default:t(()=>[l(x,{modelValue:N.value.modPath,"onUpdate:modelValue":e[19]||(e[19]=o=>N.value.modPath=o)},null,8,["modelValue"])]),_:1}),l(m,{label:"描述"},{default:t(()=>[l(x,{modelValue:N.value.description,"onUpdate:modelValue":e[20]||(e[20]=o=>N.value.description=o),type:"textarea"},null,8,["modelValue"])]),_:1}),l(m,{label:"Temperature"},{default:t(()=>[l(Y,{modelValue:N.value.temperature,"onUpdate:modelValue":e[21]||(e[21]=o=>N.value.temperature=o),min:0,max:2,step:.1,precision:1,placeholder:"0.1",style:{width:"100%"}},null,8,["modelValue"]),e[86]||(e[86]=n("div",{class:"form-tip"}," 控制翻译创造性，0.0-2.0之间，值越低翻译越保守，建议0.1-0.3 ",-1))]),_:1,__:[86]}),l(m,{label:"最大令牌数"},{default:t(()=>[l(Y,{modelValue:N.value.max_tokens,"onUpdate:modelValue":e[22]||(e[22]=o=>N.value.max_tokens=o),min:100,max:1e4,step:100,placeholder:"2000",style:{width:"100%"}},null,8,["modelValue"]),e[87]||(e[87]=n("div",{class:"form-tip"}," 控制LLM响应的最大长度，一般设置为1000-4000之间 ",-1))]),_:1,__:[87]})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(W,{modelValue:J.value,"onUpdate:modelValue":e[31]||(e[31]=o=>J.value=o),title:"API配置",width:"600px"},{footer:t(()=>[l(d,{onClick:e[30]||(e[30]=o=>J.value=!1)},{default:t(()=>e[92]||(e[92]=[r("取消")])),_:1,__:[92]}),l(d,{type:"primary",onClick:C(sl),loading:C(rl)},{default:t(()=>e[93]||(e[93]=[r(" 保存 ")])),_:1,__:[93]},8,["onClick","loading"])]),default:t(()=>[l(Z,{model:O.value,"label-width":"120px"},{default:t(()=>[l(m,{label:"API密钥",required:""},{default:t(()=>[l(x,{modelValue:O.value.api_key,"onUpdate:modelValue":e[25]||(e[25]=o=>O.value.api_key=o),type:"password","show-password":"",placeholder:"请输入OpenAI API密钥"},null,8,["modelValue"])]),_:1}),l(m,{label:"Base URL"},{default:t(()=>[l(x,{modelValue:O.value.base_url,"onUpdate:modelValue":e[26]||(e[26]=o=>O.value.base_url=o),placeholder:"https://api.openai.com/v1"},null,8,["modelValue"])]),_:1}),l(m,{label:"模型"},{default:t(()=>[l(x,{modelValue:O.value.model,"onUpdate:modelValue":e[27]||(e[27]=o=>O.value.model=o),placeholder:"gpt-3.5-turbo"},null,8,["modelValue"])]),_:1}),l(m,{label:"最大令牌数"},{default:t(()=>[l(Y,{modelValue:O.value.max_tokens,"onUpdate:modelValue":e[28]||(e[28]=o=>O.value.max_tokens=o),min:100,max:1e4,step:100,placeholder:"2000",style:{width:"100%"}},null,8,["modelValue"]),e[90]||(e[90]=n("div",{class:"form-tip"}," 控制LLM响应的最大长度，一般设置为1000-4000之间 ",-1))]),_:1,__:[90]}),l(m,{label:"Temperature"},{default:t(()=>[l(Y,{modelValue:O.value.temperature,"onUpdate:modelValue":e[29]||(e[29]=o=>O.value.temperature=o),min:0,max:2,step:.1,precision:1,placeholder:"0.1",style:{width:"100%"}},null,8,["modelValue"]),e[91]||(e[91]=n("div",{class:"form-tip"}," 控制翻译创造性，0.0-2.0之间，值越低翻译越保守，建议0.1-0.3 ",-1))]),_:1,__:[91]})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(W,{modelValue:P.value,"onUpdate:modelValue":e[33]||(e[33]=o=>P.value=o),title:"导入配置",width:"500px"},{footer:t(()=>[l(d,{onClick:e[32]||(e[32]=o=>P.value=!1)},{default:t(()=>e[96]||(e[96]=[r("取消")])),_:1,__:[96]}),l(d,{type:"primary",onClick:C(ol),loading:C(nl)},{default:t(()=>e[97]||(e[97]=[r(" 导入 ")])),_:1,__:[97]},8,["onClick","loading"])]),default:t(()=>[l($l,{ref_key:"uploadRef",ref:$,"auto-upload":!1,limit:1,accept:".json",onChange:kl},{tip:t(()=>e[95]||(e[95]=[n("div",{class:"el-upload__tip"}," 只能上传JSON格式的配置文件 ",-1)])),default:t(()=>[l(d,{type:"primary"},{default:t(()=>e[94]||(e[94]=[r("选择JSON配置文件")])),_:1,__:[94]})]),_:1},512)]),_:1},8,["modelValue"]),l(W,{modelValue:oe.value,"onUpdate:modelValue":e[35]||(e[35]=o=>oe.value=o),title:M.value?"编辑CSV文件":"添加CSV文件",width:"800px","before-close":Re},{footer:t(()=>[l(d,{onClick:Re},{default:t(()=>e[102]||(e[102]=[r("取消")])),_:1,__:[102]}),l(d,{type:"primary",onClick:_l,loading:ye.value},{default:t(()=>e[103]||(e[103]=[r(" 确定 ")])),_:1,__:[103]},8,["loading"])]),default:t(()=>[l(Z,{ref_key:"csvFormRef",ref:T,model:L.value,rules:Ge,"label-width":"100px"},{default:t(()=>[l(m,{label:"文件路径",prop:"path"},{default:t(()=>[l(x,{modelValue:L.value.path,"onUpdate:modelValue":e[34]||(e[34]=o=>L.value.path=o),placeholder:"例如: ./data/campaign/abilities.csv",disabled:M.value},null,8,["modelValue","disabled"]),e[98]||(e[98]=n("div",{class:"form-tip"},"文件路径相对于模组根目录",-1))]),_:1,__:[98]}),l(m,{label:"字段配置",prop:"fields"},{default:t(()=>[n("div",st,[(c(!0),B(te,null,ae(L.value.fields,(o,b)=>(c(),B("div",{key:b,class:"field-config-item"},[l(x,{modelValue:o.name,"onUpdate:modelValue":h=>o.name=h,placeholder:"字段名",style:{width:"200px","margin-right":"12px"},onBlur:h=>vl(o,b)},null,8,["modelValue","onUpdate:modelValue","onBlur"]),l(k,{modelValue:o.function,"onUpdate:modelValue":h=>o.function=h,placeholder:"选择处理函数",style:{width:"300px","margin-right":"12px"},filterable:""},{default:t(()=>[(c(!0),B(te,null,ae(ke("csv"),(h,Ae)=>(c(),U(u,{key:Ae,label:`${Ae} - ${h}`,value:Ae},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"]),l(d,{type:"danger",size:"small",onClick:h=>pl(b),disabled:L.value.fields.length<=1},{default:t(()=>e[99]||(e[99]=[r(" 删除 ")])),_:2,__:[99]},1032,["onClick","disabled"])]))),128)),l(d,{type:"primary",onClick:ml,icon:"Plus"},{default:t(()=>e[100]||(e[100]=[r(" 添加字段 ")])),_:1,__:[100]}),e[101]||(e[101]=n("div",{class:"form-tip"},"至少需要配置一个字段",-1))])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),l(W,{modelValue:ne.value,"onUpdate:modelValue":e[39]||(e[39]=o=>ne.value=o),title:I.value?"编辑JSON文件":"添加JSON文件",width:"600px","before-close":Ee},{footer:t(()=>[l(d,{onClick:Ee},{default:t(()=>e[106]||(e[106]=[r("取消")])),_:1,__:[106]}),l(d,{type:"primary",onClick:Cl,loading:we.value},{default:t(()=>e[107]||(e[107]=[r(" 确定 ")])),_:1,__:[107]},8,["loading"])]),default:t(()=>[l(Z,{ref_key:"jsonFormRef",ref:H,model:S.value,rules:Ke,"label-width":"100px"},{default:t(()=>[l(m,{label:"文件路径",prop:"path"},{default:t(()=>[l(x,{modelValue:S.value.path,"onUpdate:modelValue":e[36]||(e[36]=o=>S.value.path=o),placeholder:"例如: ./data/strings/strings.json",disabled:I.value},null,8,["modelValue","disabled"]),e[104]||(e[104]=n("div",{class:"form-tip"},"JSON文件路径相对于模组根目录",-1))]),_:1,__:[104]}),l(m,{label:"处理函数",prop:"extract_function"},{default:t(()=>[l(k,{modelValue:S.value.extract_function,"onUpdate:modelValue":e[37]||(e[37]=o=>S.value.extract_function=o),style:{width:"100%"},filterable:""},{default:t(()=>[(c(!0),B(te,null,ae(ke("json"),(o,b)=>(c(),U(u,{key:b,label:`${b} - ${o}`,value:b},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),e[105]||(e[105]=n("div",{class:"form-tip"},"选择适合的JSON解析函数",-1))]),_:1,__:[105]}),l(m,{label:"描述"},{default:t(()=>[l(x,{modelValue:S.value.description,"onUpdate:modelValue":e[38]||(e[38]=o=>S.value.description=o),type:"textarea",placeholder:"文件描述（可选）",rows:3},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),l(W,{modelValue:se.value,"onUpdate:modelValue":e[45]||(e[45]=o=>se.value=o),title:G.value?"编辑JAR文件":"添加JAR文件",width:"600px","before-close":Be},{footer:t(()=>[l(d,{onClick:Be},{default:t(()=>e[112]||(e[112]=[r("取消")])),_:1,__:[112]}),l(d,{type:"primary",onClick:xl,loading:Ce.value},{default:t(()=>e[113]||(e[113]=[r(" 确定 ")])),_:1,__:[113]},8,["loading"])]),default:t(()=>[l(Z,{ref_key:"jarFormRef",ref:pe,model:V.value,rules:Qe,"label-width":"100px"},{default:t(()=>[l(m,{label:"文件路径",prop:"path"},{default:t(()=>[l(x,{modelValue:V.value.path,"onUpdate:modelValue":e[40]||(e[40]=o=>V.value.path=o),placeholder:"例如: ./jars/IndEvo.jar",disabled:G.value},null,8,["modelValue","disabled"]),e[108]||(e[108]=n("div",{class:"form-tip"},"JAR文件路径相对于模组根目录",-1))]),_:1,__:[108]}),l(m,{label:"处理函数",prop:"extract_function"},{default:t(()=>[l(k,{modelValue:V.value.extract_function,"onUpdate:modelValue":e[41]||(e[41]=o=>V.value.extract_function=o),style:{width:"100%"},filterable:""},{default:t(()=>[(c(!0),B(te,null,ae(ke("jar"),(o,b)=>(c(),U(u,{key:b,label:`${b} - ${o}`,value:b},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),e[109]||(e[109]=n("div",{class:"form-tip"},"选择适合的JAR文件处理函数",-1))]),_:1,__:[109]}),l(m,{label:"描述"},{default:t(()=>[l(x,{modelValue:V.value.description,"onUpdate:modelValue":e[42]||(e[42]=o=>V.value.description=o),type:"textarea",placeholder:"文件描述（可选）",rows:3},null,8,["modelValue"])]),_:1}),l(m,{label:"备份后缀"},{default:t(()=>[l(x,{modelValue:V.value.backup_suffix,"onUpdate:modelValue":e[43]||(e[43]=o=>V.value.backup_suffix=o),placeholder:".backup"},null,8,["modelValue"]),e[110]||(e[110]=n("div",{class:"form-tip"},"原文件备份时的后缀名",-1))]),_:1,__:[110]}),l(m,{label:"输出后缀"},{default:t(()=>[l(x,{modelValue:V.value.output_suffix,"onUpdate:modelValue":e[44]||(e[44]=o=>V.value.output_suffix=o),placeholder:"_translated.jar"},null,8,["modelValue"]),e[111]||(e[111]=n("div",{class:"form-tip"},"翻译后文件的后缀名",-1))]),_:1,__:[111]})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},dt=El(rt,[["__scopeId","data-v-f575d96f"]]);export{dt as default};
