var xe=Object.defineProperty;var J=Object.getOwnPropertySymbols;var Te=Object.prototype.hasOwnProperty,Se=Object.prototype.propertyIsEnumerable;var O=(v,i,s)=>i in v?xe(v,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):v[i]=s,K=(v,i)=>{for(var s in i||(i={}))Te.call(i,s)&&O(v,s,i[s]);if(J)for(var s of J(i))Se.call(i,s)&&O(v,s,i[s]);return v};var U=(v,i,s)=>new Promise((b,y)=>{var g=f=>{try{V(s.next(f))}catch(C){y(C)}},T=f=>{try{V(s.throw(f))}catch(C){y(C)}},V=f=>f.done?b(f.value):Promise.resolve(f.value).then(g,T);V((s=s.apply(v,i)).next())});import{_ as Ue,u as De,r as p,c as M,s as j,o as he,d as D,e as c,f as t,w as o,l as Fe,j as n,m as u,i as _,G as $e,F as Q,k as W,H as ze,g as h,t as P,h as X,I as x,E as m,b as Be}from"./index-B0OZ2IFU.js";const Le={class:"terminology-view"},Pe={key:0,class:"empty-state"},Ae={key:1},Ee={class:"operations-bar"},Ie={class:"search-section"},Ne={class:"action-buttons"},Me={class:"pagination-container"},je={key:0,class:"selected-file-info"},qe={__name:"TerminologyView",setup(v){const i=De(),s=p([]),b=p(""),y=p(""),g=p(1),T=p(20),V=p(!1),f=p(!1),C=p(!1),w=p(null),S=p(!1),F=p(!1),$=p(null),r=p({term:"",translation:"",domain:"",notes:""}),q=p(),I=M(()=>{let l=s.value;if(b.value){const e=b.value.toLowerCase();l=l.filter(d=>d.term.toLowerCase().includes(e)||d.translation&&d.translation.toLowerCase().includes(e)||d.notes&&d.notes.toLowerCase().includes(e))}return y.value&&(l=l.filter(e=>e.domain===y.value)),l}),Y=M(()=>{const l=(g.value-1)*T.value,e=l+T.value;return I.value.slice(l,e)}),R=M(()=>{const l=new Set;return s.value.forEach(e=>{e.domain&&l.add(e.domain)}),Array.from(l).sort()}),z=()=>U(null,null,function*(){V.value=!0;try{const l=yield x.getTerminologyList();l.success?s.value=l.terms||[]:m.error(l.message||"加载术语列表失败")}catch(l){console.error("加载术语列表失败:",l),m.error("加载术语列表失败")}finally{V.value=!1}}),Z=l=>{$.value=l,r.value=K({},l),S.value=!0},ee=()=>U(null,null,function*(){try{if(yield q.value.validate(),f.value=!0,$.value)yield x.deleteTerminology($.value.term),yield x.addTerminology(r.value.term,r.value.translation,r.value.domain||"general",r.value.notes||""),m.success("术语更新成功");else{const l=yield x.addTerminology(r.value.term,r.value.translation,r.value.domain||"general",r.value.notes||"");l.success?m.success("术语添加成功"):m.error(l.message||"术语添加失败")}S.value=!1,te(),yield z()}catch(l){console.error("保存术语失败:",l),m.error("保存失败")}finally{f.value=!1}}),le=l=>U(null,null,function*(){try{yield Be.confirm("确定要删除这个术语吗？","删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const e=yield x.deleteTerminology(l.term);e.success?(m.success("术语删除成功"),yield z()):m.error(e.message||"删除失败")}catch(e){e!=="cancel"&&(console.error("删除术语失败:",e),m.error("删除失败"))}}),te=()=>{r.value={term:"",translation:"",domain:"",notes:""},$.value=null},oe=()=>{F.value=!0},ae=()=>U(null,null,function*(){try{yield x.exportTerminology(),m.success("导出完成")}catch(l){console.error("导出失败:",l),m.error("导出失败")}}),ne=l=>{w.value=l.raw,m.success(`已选择文件: ${l.name}`)},se=()=>U(null,null,function*(){if(!w.value){m.warning("请先选择文件");return}try{C.value=!0;const l=yield x.importTerminology(w.value);l.success?(m.success(l.message),F.value=!1,w.value=null,yield z()):m.error(l.message||"导入失败")}catch(l){console.error("导入失败:",l),m.error("导入失败")}finally{C.value=!1}}),re=l=>l?new Date(l).toLocaleDateString():"-",ue=l=>{g.value=l};return j(()=>i.isConfigSelected,l=>{l&&s.value.length===0&&z()}),j([b,y],()=>{g.value=1}),j(()=>I.value.length,l=>{const e=Math.ceil(l/T.value);e>0&&g.value>e&&(g.value=e),l===0&&(g.value=1)}),he(()=>{i.isConfigSelected&&z()}),(l,e)=>{const d=n("el-button"),ie=n("el-empty"),de=n("Search"),B=n("el-icon"),A=n("el-input"),N=n("el-option"),G=n("el-select"),me=n("Plus"),pe=n("Upload"),ce=n("Download"),L=n("el-text"),k=n("el-table-column"),fe=n("el-tag"),ve=n("el-table"),_e=n("el-pagination"),E=n("el-form-item"),ge=n("el-form"),H=n("el-dialog"),ye=n("upload-filled"),we=n("el-upload"),be=n("el-alert"),Ve=n("el-card"),Ce=ze("loading");return c(),D("div",Le,[t(Ve,{class:"header-card"},{header:o(()=>e[12]||(e[12]=[_("div",{class:"card-header"},[_("span",null,"📚 专有名词管理"),_("p",null,"管理翻译中的专业术语和固定译名")],-1)])),default:o(()=>[Fe(i).isConfigSelected?(c(),D("div",Ae,[_("div",Ee,[_("div",Ie,[t(A,{modelValue:b.value,"onUpdate:modelValue":e[1]||(e[1]=a=>b.value=a),placeholder:"搜索术语或译名...",style:{width:"300px"},clearable:""},{prefix:o(()=>[t(B,null,{default:o(()=>[t(de)]),_:1})]),_:1},8,["modelValue"]),t(G,{modelValue:y.value,"onUpdate:modelValue":e[2]||(e[2]=a=>y.value=a),style:{width:"150px","margin-left":"12px"}},{default:o(()=>[t(N,{label:"全部分类",value:""}),(c(!0),D(Q,null,W(R.value,a=>(c(),h(N,{key:a,label:a,value:a},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_("div",Ne,[t(d,{type:"primary",onClick:e[3]||(e[3]=a=>S.value=!0)},{default:o(()=>[t(B,null,{default:o(()=>[t(me)]),_:1}),e[14]||(e[14]=u(" 添加术语 "))]),_:1,__:[14]}),t(d,{onClick:oe},{default:o(()=>[t(B,null,{default:o(()=>[t(pe)]),_:1}),e[15]||(e[15]=u(" 导入 "))]),_:1,__:[15]}),t(d,{onClick:ae},{default:o(()=>[t(B,null,{default:o(()=>[t(ce)]),_:1}),e[16]||(e[16]=u(" 导出 "))]),_:1,__:[16]})])]),$e((c(),h(ve,{data:Y.value,style:{width:"100%"},stripe:""},{default:o(()=>[t(k,{prop:"term",label:"原术语","min-width":"150"},{default:o(a=>[t(L,{type:"primary"},{default:o(()=>[u(P(a.row.term),1)]),_:2},1024)]),_:1}),t(k,{prop:"translation",label:"译名","min-width":"150"},{default:o(a=>[a.row.translation?(c(),h(L,{key:0,type:"primary"},{default:o(()=>[u(P(a.row.translation),1)]),_:2},1024)):(c(),h(L,{key:1,type:"info"},{default:o(()=>e[17]||(e[17]=[u("未翻译")])),_:1,__:[17]}))]),_:1}),t(k,{prop:"domain",label:"分类",width:"120"},{default:o(a=>[a.row.domain?(c(),h(fe,{key:0,size:"small"},{default:o(()=>[u(P(a.row.domain),1)]),_:2},1024)):X("",!0)]),_:1}),t(k,{prop:"notes",label:"说明","min-width":"200","show-overflow-tooltip":""}),t(k,{prop:"frequency",label:"使用频率",width:"100",sortable:""},{default:o(a=>[t(L,null,{default:o(()=>[u(P(a.row.frequency||0),1)]),_:2},1024)]),_:1}),t(k,{prop:"lastUsed",label:"最后使用",width:"120"},{default:o(a=>[t(L,{type:"info",size:"small"},{default:o(()=>[u(P(re(a.row.lastUsed)),1)]),_:2},1024)]),_:1}),t(k,{label:"操作",width:"150",fixed:"right"},{default:o(a=>[t(d,{type:"primary",size:"small",onClick:ke=>Z(a.row)},{default:o(()=>e[18]||(e[18]=[u(" 编辑 ")])),_:2,__:[18]},1032,["onClick"]),t(d,{type:"danger",size:"small",onClick:ke=>le(a.row)},{default:o(()=>e[19]||(e[19]=[u(" 删除 ")])),_:2,__:[19]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[Ce,V.value]]),_("div",Me,[t(_e,{"current-page":g.value,"page-size":T.value,total:I.value.length,layout:"prev, pager, next, jumper, total",onCurrentChange:ue},null,8,["current-page","page-size","total"])]),t(H,{modelValue:S.value,"onUpdate:modelValue":e[9]||(e[9]=a=>S.value=a),title:$.value?"编辑术语":"添加术语",width:"600px"},{footer:o(()=>[t(d,{onClick:e[8]||(e[8]=a=>S.value=!1)},{default:o(()=>e[20]||(e[20]=[u("取消")])),_:1,__:[20]}),t(d,{type:"primary",onClick:ee,loading:f.value},{default:o(()=>e[21]||(e[21]=[u("确定")])),_:1,__:[21]},8,["loading"])]),default:o(()=>[t(ge,{model:r.value,"label-width":"80px",ref_key:"termFormRef",ref:q},{default:o(()=>[t(E,{label:"原术语",prop:"term",rules:[{required:!0,message:"请输入原术语"}]},{default:o(()=>[t(A,{modelValue:r.value.term,"onUpdate:modelValue":e[4]||(e[4]=a=>r.value.term=a),placeholder:"请输入原术语"},null,8,["modelValue"])]),_:1}),t(E,{label:"译名",prop:"translation"},{default:o(()=>[t(A,{modelValue:r.value.translation,"onUpdate:modelValue":e[5]||(e[5]=a=>r.value.translation=a),placeholder:"请输入译名"},null,8,["modelValue"])]),_:1}),t(E,{label:"分类",prop:"domain"},{default:o(()=>[t(G,{modelValue:r.value.domain,"onUpdate:modelValue":e[6]||(e[6]=a=>r.value.domain=a),placeholder:"选择或输入分类",filterable:"","allow-create":""},{default:o(()=>[(c(!0),D(Q,null,W(R.value,a=>(c(),h(N,{key:a,label:a,value:a},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(E,{label:"说明",prop:"notes"},{default:o(()=>[t(A,{modelValue:r.value.notes,"onUpdate:modelValue":e[7]||(e[7]=a=>r.value.notes=a),type:"textarea",rows:3,placeholder:"术语说明或使用场景"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),t(H,{modelValue:F.value,"onUpdate:modelValue":e[11]||(e[11]=a=>F.value=a),title:"导入术语",width:"500px"},{footer:o(()=>[t(d,{onClick:e[10]||(e[10]=a=>{F.value=!1,w.value=null})},{default:o(()=>e[24]||(e[24]=[u("取消")])),_:1,__:[24]}),t(d,{type:"primary",onClick:se,loading:C.value,disabled:!w.value},{default:o(()=>e[25]||(e[25]=[u(" 导入 ")])),_:1,__:[25]},8,["loading","disabled"])]),default:o(()=>[t(we,{ref:"uploadRef","auto-upload":!1,"on-change":ne,"show-file-list":!1,accept:".json",drag:""},{tip:o(()=>e[22]||(e[22]=[_("div",{class:"el-upload__tip"}," 只支持 JSON 格式文件 ",-1)])),default:o(()=>[t(B,{class:"el-icon--upload"},{default:o(()=>[t(ye)]),_:1}),e[23]||(e[23]=_("div",{class:"el-upload__text"},[u(" 将文件拖到此处，或"),_("em",null,"点击上传")],-1))]),_:1,__:[23]},512),w.value?(c(),D("div",je,[t(be,{title:`已选择文件: ${w.value.name}`,type:"success",closable:!1,"show-icon":""},null,8,["title"])])):X("",!0)]),_:1},8,["modelValue"])])):(c(),D("div",Pe,[t(ie,{description:"请先选择配置"},{default:o(()=>[t(d,{type:"primary",onClick:e[0]||(e[0]=a=>l.$router.push("/"))},{default:o(()=>e[13]||(e[13]=[u(" 去配置管理 ")])),_:1,__:[13]})]),_:1})]))]),_:1})])}}},He=Ue(qe,[["__scopeId","data-v-bed40118"]]);export{He as default};
