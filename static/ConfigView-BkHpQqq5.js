var Fl=Object.defineProperty,Jl=Object.defineProperties;var Al=Object.getOwnPropertyDescriptors;var Ee=Object.getOwnPropertySymbols;var Nl=Object.prototype.hasOwnProperty,Sl=Object.prototype.propertyIsEnumerable;var Be=(c,v,m)=>v in c?Fl(c,v,{enumerable:!0,configurable:!0,writable:!0,value:m}):c[v]=m,se=(c,v)=>{for(var m in v||(v={}))Nl.call(v,m)&&Be(c,m,v[m]);if(Ee)for(var m of Ee(v))Sl.call(v,m)&&Be(c,m,v[m]);return c},De=(c,v)=>Jl(c,Al(v));var _=(c,v,m)=>new Promise((L,E)=>{var k=j=>{try{D(m.next(j))}catch(O){E(O)}},N=j=>{try{D(m.throw(j))}catch(O){E(O)}},D=j=>j.done?L(j.value):Promise.resolve(j.value).then(k,N);D((m=m.apply(c,v)).next())});import{r as f,_ as $l,u as Ul,c as W,E as n,a as q,b as re,o as Ll,d as P,e as p,f as l,g as A,h as ie,w as t,i as s,j as y,F as X,k as Y,l as b,m as r,t as J,n as ue,p as Ol,q as Te}from"./index-jGo40FSK.js";function qe(){const c=f(new Map);return{createLoadingHandler:(k,N="default")=>{c.value.has(N)||c.value.set(N,!1);const D=f(!1),j=T=>{D.value=T,c.value.set(N,T)};return{handler:(...T)=>_(null,null,function*(){if(!c.value.get(N))try{return j(!0),yield k(...T)}catch(z){throw z}finally{j(!1)}}),loading:D,isLoading:()=>c.value.get(N)||!1}},getLoadingState:(k="default")=>c.value.get(k)||!1,clearLoading:(k="default")=>{c.value.set(k,!1)},clearAllLoading:()=>{for(const[k]of c.value)c.value.set(k,!1)},loadingStates:c}}qe();const hl={class:"config-view"},Rl={class:"config-selector"},Pl={class:"empty-state"},El={class:"empty-state"},Bl={style:{display:"flex","justify-content":"space-between","align-items":"center"}},Dl={class:"file-config-section"},Tl={class:"section-header"},ql={class:"config-count"},zl={key:1,class:"empty-state"},Hl={class:"file-config-section"},Ml={class:"section-header"},Il={class:"config-count"},Gl={key:1,class:"empty-state"},Kl={class:"file-config-section"},Ql={class:"section-header"},Wl={class:"config-count"},Xl={style:{"font-size":"12px",color:"var(--el-text-color-secondary)"}},Yl={key:1,class:"empty-state"},Zl={class:"field-config-list"},et={__name:"ConfigView",setup(c){const v=Ul(),{createLoadingHandler:m}=qe(),L=f(""),E=f(!1),k=f(!1),N=f(!1),D=f(),j=f(null),O=f(),T=f(),z=f(),Ae=f("csv"),me=f({}),g=f({csv_files:{},json_files:{},jar_files:{}}),ce=f(!1),ge=f(!1),_e=f(!1),ye=f(!1),Z=f(!1),H=f(!1),S=f({path:"",fields:[{name:"",function:""}]}),ze={path:[{required:!0,message:"请输入文件路径",trigger:"blur"},{pattern:/^\.\/.*\.csv$/i,message:'文件路径必须以"./"开头且以".csv"结尾',trigger:"blur"}],fields:[{validator:(a,e,i)=>{if(!e||e.length===0){i(new Error("至少需要配置一个字段"));return}const x=e.filter(G=>G.name.trim()&&G.function);if(x.length===0){i(new Error("至少需要配置一个完整的字段"));return}const te=x.map(G=>G.name.trim()),u=[...new Set(te)];if(te.length!==u.length){i(new Error("字段名不能重复"));return}i()},trigger:"change"}]},He={path:[{required:!0,message:"请输入文件路径",trigger:"blur"},{pattern:/^\.\/.*\.json$/i,message:'文件路径必须以"./"开头且以".json"结尾',trigger:"blur"}],extract_function:[{required:!0,message:"请选择处理函数",trigger:"change"}]},Me={path:[{required:!0,message:"请输入文件路径",trigger:"blur"},{pattern:/^\.\/.*\.jar$/i,message:'文件路径必须以"./"开头且以".jar"结尾',trigger:"blur"}],extract_function:[{required:!0,message:"请选择处理函数",trigger:"change"}]},ee=f(!1),M=f(!1),$=f({path:"",extract_function:"",description:""}),le=f(!1),I=f(!1),C=f({path:"",extract_function:"jar_extract",description:"",backup_suffix:".backup",output_suffix:"_translated.jar"}),h=f({configName:"",modName:"",modPath:"",description:""}),R=f({api_key:"",base_url:"https://api.openai.com/v1",model:"gpt-3.5-turbo",max_tokens:2e3}),de=f(null),we=W(()=>v.configs),d=W(()=>v.currentConfig),Ce=W(()=>{const a={};return Object.entries(me.value).forEach(([e,i])=>{typeof i=="string"?a[e]=i:typeof i=="object"&&i.description&&(a[e]=i.description)}),a}),be=a=>{const e={};return Object.entries(me.value).forEach(([i,x])=>{typeof x=="string"?e[i]=x:typeof x=="object"&&x.description&&(x.file_type===a||!x.file_type)&&(e[i]=x.description)}),e},Ve=W(()=>Object.entries(g.value.csv_files||{}).map(([a,e])=>({path:a,fields:e}))),xe=W(()=>Object.entries(g.value.json_files||{}).map(([a,e])=>se({path:a},e))),ke=W(()=>Object.entries(g.value.jar_files||{}).map(([a,e])=>se({path:a},e))),fe=()=>_(null,null,function*(){try{yield v.loadConfigs()}catch(a){n.error("加载配置失败")}}),{handler:Ie,loading:Ge}=m(()=>_(null,null,function*(){const a=h.value;if(!a.configName||!a.modName||!a.modPath){n.warning("请填写必填项");return}try{const e=yield q.createConfig(a.configName,a.modName,a.modPath,a.description);if(e.success){n.success("配置创建成功"),E.value=!1;const i=a.configName;h.value={configName:"",modName:"",modPath:"",description:""},yield fe(),L.value=i,yield Pe(i)}else n.error(e.message)}catch(e){n.error("创建配置失败")}}),"createConfig"),{handler:Ke,loading:Qe}=m(()=>_(null,null,function*(){if(d.value)try{yield re.confirm("确定要删除当前配置吗？此操作不可撤销。","警告",{type:"warning"});const a=yield q.deleteConfig(d.value.name);a.success?(n.success("配置删除成功"),v.clearCurrentConfig(),L.value="",yield fe()):n.error(a.message)}catch(a){a!=="cancel"&&n.error("删除配置失败")}}),"deleteConfig"),{handler:We,loading:Xe}=m(()=>_(null,null,function*(){if(d.value)try{const a=yield q.exportConfig(d.value.name),e=window.URL.createObjectURL(a),i=document.createElement("a");i.href=e,i.download=`${d.value.name}_export.json`,i.click(),window.URL.revokeObjectURL(e),n.success("配置导出成功")}catch(a){n.error("导出配置失败")}}),"exportConfig"),{handler:Ye,loading:Ze}=m(()=>_(null,null,function*(){if(!d.value){n.warning("请先选择一个配置");return}try{yield re.confirm("该操作会完全覆盖现有配置，是否继续？","自动配置确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const a=d.value.filename||d.value.name,e=yield q.autoDetectFiles(a);if(e.success){n.success(e.message),yield v.selectConfig(a),yield pe();try{yield Ne(),n.success("自动配置已保存")}catch(i){n.warning("自动配置完成，但保存失败，请手动保存"),console.error("自动保存失败:",i)}}else n.error(e.message)}catch(a){a!=="cancel"&&n.error("自动配置失败")}}),"autoConfig"),{handler:el,loading:ll}=m(()=>_(null,null,function*(){var e;if(!j.value){n.warning("请选择文件");return}const a=new FormData;a.append("config_file",j.value);try{const i=yield q.importConfig(a);i.success?(n.success(i.message),N.value=!1,j.value=null,(e=D.value)==null||e.clearFiles(),yield fe()):n.error(i.message)}catch(i){n.error("导入配置失败")}}),"importConfig"),{handler:tl,loading:al}=m(()=>_(null,null,function*(){try{const a=yield q.saveGlobalConfig(R.value);a.success?(n.success("API配置保存成功"),k.value=!1,yield Re()):n.error(a.message)}catch(a){n.error("保存API配置失败")}}),"saveApiConfig"),ol=()=>_(null,null,function*(){try{const a=yield Ol.getExtractFunctions();me.value=a}catch(a){console.error("加载提取函数失败:",a)}}),pe=()=>_(null,null,function*(){if(d.value)try{g.value={csv_files:d.value.csv_files||{},json_files:d.value.json_files||{},jar_files:d.value.jar_files||{}}}catch(a){console.error("加载配置内容失败:",a)}}),{handler:Ne,loading:nl}=m(()=>_(null,null,function*(){if(d.value)try{if(Object.keys(g.value.csv_files).length+Object.keys(g.value.json_files).length+Object.keys(g.value.jar_files).length===0){n.warning("请至少配置一个翻译文件");return}const e=De(se({},d.value),{csv_files:g.value.csv_files,json_files:g.value.json_files,jar_files:g.value.jar_files}),i=yield q.saveConfig(d.value.name,e);if(i.success){n.success("配置保存成功");const x=d.value.filename||d.value.name;yield v.selectConfig(x),yield pe()}else n.error(i.message||"保存配置失败")}catch(a){console.error("保存配置失败:",a),n.error("保存配置失败")}}),"saveConfigContent"),sl=()=>{S.value.fields.push({name:"",function:""})},rl=a=>{S.value.fields.length>1&&(S.value.fields.splice(a,1),Te(()=>{var e;(e=O.value)==null||e.validateField("fields")}))},il=(a,e)=>{a.name.trim()&&Te(()=>{var i;(i=O.value)==null||i.validateField("fields")})},ul=a=>{H.value=!0,S.value={path:a.path,fields:Object.entries(a.fields).map(([e,i])=>({name:e,function:i}))},Z.value=!0},dl=a=>_(null,null,function*(){try{yield re.confirm("确定要删除这个CSV文件配置吗？","删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),delete g.value.csv_files[a],n.success("CSV文件配置删除成功")}catch(e){}}),fl=()=>_(null,null,function*(){if(O.value){try{yield O.value.validate()}catch(a){return}ce.value=!0;try{if(!H.value&&g.value.csv_files[S.value.path]){n.error("该文件路径已存在");return}const a={};for(const e of S.value.fields)e.name.trim()&&e.function&&(a[e.name.trim()]=e.function);g.value.csv_files[S.value.path]=a,n.success(`CSV文件配置${H.value?"更新":"添加"}成功`),setTimeout(()=>{(Object.keys(g.value.csv_files).length>0||Object.keys(g.value.json_files).length>0||Object.keys(g.value.jar_files).length>0)&&n({message:'别忘了点击"保存配置"按钮保存到后端！',type:"warning",duration:3e3})},1e3),Se()}catch(a){n.error(`${H.value?"更新":"添加"}CSV文件配置失败`)}finally{ce.value=!1}}}),Se=()=>{var a;Z.value=!1,H.value=!1,S.value={path:"",fields:[{name:"",function:""}]},(a=O.value)==null||a.clearValidate()},$e=()=>{Se()},pl=a=>{M.value=!0,$.value={path:a.path,extract_function:a.extract_function,description:a.description||""},ee.value=!0},vl=a=>_(null,null,function*(){try{yield re.confirm("确定要删除这个JSON文件配置吗？","删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),delete g.value.json_files[a],n.success("JSON文件配置删除成功")}catch(e){}}),ml=()=>_(null,null,function*(){if(T.value){try{yield T.value.validate()}catch(a){return}ge.value=!0;try{if(!M.value&&g.value.json_files[$.value.path]){n.error("该文件路径已存在");return}g.value.json_files[$.value.path]={extract_function:$.value.extract_function,description:$.value.description},n.success(`JSON文件配置${M.value?"更新":"添加"}成功`),setTimeout(()=>{n({message:'别忘了点击"保存配置"按钮保存到后端！',type:"warning",duration:3e3})},1e3),Ue()}catch(a){n.error(`${M.value?"更新":"添加"}JSON文件配置失败`)}finally{ge.value=!1}}}),Ue=()=>{var a;ee.value=!1,M.value=!1,$.value={path:"",extract_function:"",description:""},(a=T.value)==null||a.clearValidate()},Le=()=>{Ue()},cl=a=>{I.value=!0,C.value={path:a.path,extract_function:a.extract_function||"jar_extract",description:a.description||"",backup_suffix:a.backup_suffix||".backup",output_suffix:a.output_suffix||"_translated.jar"},le.value=!0},gl=a=>_(null,null,function*(){try{yield re.confirm("确定要删除这个JAR文件配置吗？","删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),delete g.value.jar_files[a],n.success("JAR文件配置删除成功")}catch(e){}}),_l=()=>_(null,null,function*(){if(z.value){try{yield z.value.validate()}catch(a){return}_e.value=!0;try{if(!I.value&&g.value.jar_files[C.value.path]){n.error("该文件路径已存在");return}g.value.jar_files[C.value.path]={extract_function:C.value.extract_function||"jar_extract",description:C.value.description,backup_suffix:C.value.backup_suffix||".backup",output_suffix:C.value.output_suffix||"_translated.jar"},n.success(`JAR文件配置${I.value?"更新":"添加"}成功`),setTimeout(()=>{n({message:'别忘了点击"保存配置"按钮保存到后端！',type:"warning",duration:3e3})},1e3),Oe()}catch(a){n.error(`${I.value?"更新":"添加"}JAR文件配置失败`)}finally{_e.value=!1}}}),Oe=()=>{var a;le.value=!1,I.value=!1,C.value={path:"",extract_function:"jar_extract",description:"",backup_suffix:".backup",output_suffix:"_translated.jar"},(a=z.value)==null||a.clearValidate()},he=()=>{Oe()},yl=a=>{j.value=a.raw},wl=()=>_(null,null,function*(){try{const a=yield q.getGlobalConfig();a.success&&(R.value=se({},a.config))}catch(a){console.error("加载API配置失败:",a)}}),Re=()=>_(null,null,function*(){try{const a=yield q.checkApiConfig();a.success&&(de.value=a)}catch(a){console.error("检查API状态失败:",a)}}),Pe=a=>_(null,null,function*(){if(a==="__create_new__"){L.value="",E.value=!0;return}if(a&&a!=="__create_new__"){ye.value=!0;try{const e=yield v.selectConfig(a);e.success?(n.success(e.message),yield pe()):(n.error(e.message),L.value="")}catch(e){n.error("选择配置失败"),L.value=""}finally{ye.value=!1}}});return Ll(()=>_(null,null,function*(){try{yield Promise.all([fe(),ol(),wl(),Re()]),yield v.getCurrentConfig(),d.value&&(L.value=d.value.filename||d.value.name,yield pe())}catch(a){console.error("初始化失败:",a),n.error("页面初始化失败，请刷新重试")}})),(a,e)=>{const i=y("el-option"),x=y("el-select"),te=y("el-col"),u=y("el-button"),G=y("el-space"),Cl=y("el-row"),K=y("el-card"),ae=y("el-descriptions-item"),bl=y("el-descriptions"),oe=y("el-icon"),U=y("el-table-column"),ve=y("el-tag"),je=y("el-table"),Fe=y("el-tab-pane"),Vl=y("el-tabs"),xl=y("el-alert"),F=y("el-input"),V=y("el-form-item"),ne=y("el-form"),Q=y("el-dialog"),kl=y("el-input-number"),jl=y("el-upload");return p(),P("div",hl,[l(K,{class:"header-card"},{header:t(()=>e[34]||(e[34]=[s("div",{class:"card-header"},[s("span",null,"⚙️ 配置管理"),s("p",null,"选择或创建翻译配置文件")],-1)])),default:t(()=>[s("div",Rl,[l(Cl,{gutter:16,align:"middle"},{default:t(()=>[l(te,{span:12},{default:t(()=>[l(x,{modelValue:L.value,"onUpdate:modelValue":e[0]||(e[0]=o=>L.value=o),placeholder:"请选择配置...",style:{width:"100%"},onChange:Pe,loading:ye.value},{default:t(()=>[l(i,{key:"create-new",label:"+ 创建新配置",value:"__create_new__"}),(p(!0),P(X,null,Y(we.value,o=>(p(),A(i,{key:o.filename,label:`${o.name} (${o.filename})`,value:o.filename},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])]),_:1}),d.value?(p(),A(te,{key:0,span:12},{default:t(()=>[l(G,null,{default:t(()=>[l(u,{type:"warning",onClick:b(Ye),loading:b(Ze)},{default:t(()=>e[35]||(e[35]=[r(" 自动配置 ")])),_:1,__:[35]},8,["onClick","loading"]),l(u,{type:"info",onClick:b(We),loading:b(Xe)},{default:t(()=>e[36]||(e[36]=[r(" 导出配置 ")])),_:1,__:[36]},8,["onClick","loading"]),l(u,{type:"info",onClick:e[1]||(e[1]=o=>N.value=!0)},{default:t(()=>e[37]||(e[37]=[r(" 导入配置 ")])),_:1,__:[37]}),l(u,{type:"danger",onClick:b(Ke),loading:b(Qe)},{default:t(()=>e[38]||(e[38]=[r(" 删除配置 ")])),_:1,__:[38]},8,["onClick","loading"])]),_:1})]),_:1})):ie("",!0)]),_:1})])]),_:1}),d.value?(p(),A(K,{key:0,class:"config-info-card"},{header:t(()=>e[39]||(e[39]=[s("span",null,"📋 当前配置信息",-1)])),default:t(()=>[l(bl,{column:2,border:""},{default:t(()=>[l(ae,{label:"配置名称"},{default:t(()=>[r(J(d.value.name),1)]),_:1}),l(ae,{label:"模组名称"},{default:t(()=>[r(J(d.value.mod_name),1)]),_:1}),l(ae,{label:"模组路径"},{default:t(()=>[r(J(d.value.mod_path),1)]),_:1}),l(ae,{label:"工作目录"},{default:t(()=>[r(J(d.value.work_directory),1)]),_:1}),l(ae,{label:"描述",span:2},{default:t(()=>[r(J(d.value.description||"无描述"),1)]),_:1})]),_:1})]),_:1})):ie("",!0),!d.value&&we.value.length===0?(p(),A(K,{key:1,class:"empty-config-card"},{default:t(()=>[s("div",Pl,[l(oe,null,{default:t(()=>[l(b(ue))]),_:1}),e[41]||(e[41]=s("h3",null,"暂无配置文件",-1)),e[42]||(e[42]=s("p",null,"请先创建一个翻译配置文件开始使用",-1)),l(u,{type:"primary",onClick:e[2]||(e[2]=o=>E.value=!0),size:"large"},{default:t(()=>e[40]||(e[40]=[r(" 创建新配置 ")])),_:1,__:[40]})])]),_:1})):!d.value&&we.value.length>0?(p(),A(K,{key:2,class:"empty-config-card"},{default:t(()=>[s("div",El,[l(oe,null,{default:t(()=>[l(b(ue))]),_:1}),e[43]||(e[43]=s("h3",null,"请选择一个配置文件",-1)),e[44]||(e[44]=s("p",null,"从上方下拉菜单中选择一个已有的配置文件",-1))])]),_:1})):ie("",!0),d.value?(p(),A(K,{key:3,class:"config-edit-card"},{header:t(()=>[s("div",Bl,[e[46]||(e[46]=s("span",null,"📝 编辑配置文件",-1)),l(u,{type:"primary",onClick:b(Ne),loading:b(nl)},{default:t(()=>e[45]||(e[45]=[r(" 保存配置 ")])),_:1,__:[45]},8,["onClick","loading"])])]),default:t(()=>[l(Vl,{modelValue:Ae.value,"onUpdate:modelValue":e[6]||(e[6]=o=>Ae.value=o)},{default:t(()=>[l(Fe,{label:"CSV文件",name:"csv"},{default:t(()=>[s("div",Dl,[s("div",Tl,[s("h4",null,[e[47]||(e[47]=r("CSV文件配置 ")),s("span",ql,"("+J(Ve.value.length)+" 个文件)",1)]),l(u,{type:"primary",onClick:e[3]||(e[3]=o=>Z.value=!0)},{default:t(()=>e[48]||(e[48]=[r(" 添加CSV文件 ")])),_:1,__:[48]})]),Ve.value.length>0?(p(),A(je,{key:0,data:Ve.value,stripe:""},{default:t(()=>[l(U,{prop:"path",label:"文件路径","min-width":"200","show-overflow-tooltip":""}),l(U,{label:"字段数量",width:"100"},{default:t(o=>[l(ve,{type:"info",size:"small"},{default:t(()=>[r(J(Object.keys(o.row.fields).length)+" 个字段 ",1)]),_:2},1024)]),_:1}),l(U,{label:"配置字段","min-width":"300"},{default:t(o=>[(p(!0),P(X,null,Y(o.row.fields,(w,B)=>(p(),A(ve,{key:B,type:"info",size:"small"},{default:t(()=>[r(J(B)+": "+J(Ce.value[w]||w),1)]),_:2},1024))),128))]),_:1}),l(U,{label:"操作",width:"150",fixed:"right"},{default:t(o=>[l(u,{size:"small",onClick:w=>ul(o.row)},{default:t(()=>e[49]||(e[49]=[r("编辑")])),_:2,__:[49]},1032,["onClick"]),l(u,{size:"small",type:"danger",onClick:w=>dl(o.row.path)},{default:t(()=>e[50]||(e[50]=[r("删除")])),_:2,__:[50]},1032,["onClick"])]),_:1})]),_:1},8,["data"])):(p(),P("div",zl,[l(oe,null,{default:t(()=>[l(b(ue))]),_:1}),e[51]||(e[51]=s("p",null,"暂未配置CSV文件",-1)),e[52]||(e[52]=s("p",null,'点击"添加CSV文件"按钮开始配置',-1))]))])]),_:1}),l(Fe,{label:"JSON文件",name:"json"},{default:t(()=>[s("div",Hl,[s("div",Ml,[s("h4",null,[e[53]||(e[53]=r("JSON文件配置 ")),s("span",Il,"("+J(xe.value.length)+" 个文件)",1)]),l(u,{type:"primary",onClick:e[4]||(e[4]=o=>ee.value=!0)},{default:t(()=>e[54]||(e[54]=[r(" 添加JSON文件 ")])),_:1,__:[54]})]),xe.value.length>0?(p(),A(je,{key:0,data:xe.value,stripe:""},{default:t(()=>[l(U,{prop:"path",label:"文件路径","min-width":"200","show-overflow-tooltip":""}),l(U,{label:"处理函数",width:"200"},{default:t(o=>[l(ve,{type:"success"},{default:t(()=>[r(J(Ce.value[o.row.extract_function]||o.row.extract_function),1)]),_:2},1024)]),_:1}),l(U,{prop:"description",label:"描述","show-overflow-tooltip":""}),l(U,{label:"操作",width:"150",fixed:"right"},{default:t(o=>[l(u,{size:"small",onClick:w=>pl(o.row)},{default:t(()=>e[55]||(e[55]=[r("编辑")])),_:2,__:[55]},1032,["onClick"]),l(u,{size:"small",type:"danger",onClick:w=>vl(o.row.path)},{default:t(()=>e[56]||(e[56]=[r("删除")])),_:2,__:[56]},1032,["onClick"])]),_:1})]),_:1},8,["data"])):(p(),P("div",Gl,[l(oe,null,{default:t(()=>[l(b(ue))]),_:1}),e[57]||(e[57]=s("p",null,"暂未配置JSON文件",-1)),e[58]||(e[58]=s("p",null,'点击"添加JSON文件"按钮开始配置',-1))]))])]),_:1}),l(Fe,{label:"JAR文件",name:"jar"},{default:t(()=>[s("div",Kl,[s("div",Ql,[s("h4",null,[e[59]||(e[59]=r("JAR文件配置 ")),s("span",Wl,"("+J(ke.value.length)+" 个文件)",1)]),l(u,{type:"primary",onClick:e[5]||(e[5]=o=>le.value=!0)},{default:t(()=>e[60]||(e[60]=[r(" 添加JAR文件 ")])),_:1,__:[60]})]),ke.value.length>0?(p(),A(je,{key:0,data:ke.value,stripe:""},{default:t(()=>[l(U,{prop:"path",label:"文件路径","min-width":"200","show-overflow-tooltip":""}),l(U,{label:"处理函数",width:"200"},{default:t(o=>[l(ve,{type:"success"},{default:t(()=>[r(J(Ce.value[o.row.extract_function]||o.row.extract_function),1)]),_:2},1024)]),_:1}),l(U,{prop:"description",label:"描述","show-overflow-tooltip":""}),l(U,{label:"配置",width:"200"},{default:t(o=>[s("div",Xl,[r(" 备份: "+J(o.row.backup_suffix||".backup"),1),e[61]||(e[61]=s("br",null,null,-1)),r(" 输出: "+J(o.row.output_suffix||"_translated.jar"),1)])]),_:1}),l(U,{label:"操作",width:"150",fixed:"right"},{default:t(o=>[l(u,{size:"small",onClick:w=>cl(o.row)},{default:t(()=>e[62]||(e[62]=[r("编辑")])),_:2,__:[62]},1032,["onClick"]),l(u,{size:"small",type:"danger",onClick:w=>gl(o.row.path)},{default:t(()=>e[63]||(e[63]=[r("删除")])),_:2,__:[63]},1032,["onClick"])]),_:1})]),_:1},8,["data"])):(p(),P("div",Yl,[l(oe,null,{default:t(()=>[l(b(ue))]),_:1}),e[64]||(e[64]=s("p",null,"暂未配置JAR文件",-1)),e[65]||(e[65]=s("p",null,'点击"添加JAR文件"按钮开始配置',-1))]))])]),_:1})]),_:1},8,["modelValue"])]),_:1})):ie("",!0),l(K,{class:"api-status-card"},{header:t(()=>e[66]||(e[66]=[s("span",null,"🔑 API配置状态",-1)])),default:t(()=>[de.value?(p(),A(xl,{key:0,title:de.value.message,type:de.value.is_valid?"success":"error",closable:!1,style:{"margin-bottom":"16px"}},null,8,["title","type"])):ie("",!0),l(u,{type:"primary",onClick:e[7]||(e[7]=o=>k.value=!0)},{default:t(()=>e[67]||(e[67]=[r(" 配置API设置 ")])),_:1,__:[67]})]),_:1}),l(Q,{modelValue:E.value,"onUpdate:modelValue":e[13]||(e[13]=o=>E.value=o),title:"新建配置",width:"500px"},{footer:t(()=>[l(u,{onClick:e[12]||(e[12]=o=>E.value=!1)},{default:t(()=>e[68]||(e[68]=[r("取消")])),_:1,__:[68]}),l(u,{type:"primary",onClick:b(Ie),loading:b(Ge)},{default:t(()=>e[69]||(e[69]=[r(" 创建 ")])),_:1,__:[69]},8,["onClick","loading"])]),default:t(()=>[l(ne,{model:h.value,"label-width":"100px"},{default:t(()=>[l(V,{label:"配置名称",required:""},{default:t(()=>[l(F,{modelValue:h.value.configName,"onUpdate:modelValue":e[8]||(e[8]=o=>h.value.configName=o),placeholder:"不含扩展名"},null,8,["modelValue"])]),_:1}),l(V,{label:"模组名称",required:""},{default:t(()=>[l(F,{modelValue:h.value.modName,"onUpdate:modelValue":e[9]||(e[9]=o=>h.value.modName=o)},null,8,["modelValue"])]),_:1}),l(V,{label:"模组路径",required:""},{default:t(()=>[l(F,{modelValue:h.value.modPath,"onUpdate:modelValue":e[10]||(e[10]=o=>h.value.modPath=o)},null,8,["modelValue"])]),_:1}),l(V,{label:"描述"},{default:t(()=>[l(F,{modelValue:h.value.description,"onUpdate:modelValue":e[11]||(e[11]=o=>h.value.description=o),type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(Q,{modelValue:k.value,"onUpdate:modelValue":e[19]||(e[19]=o=>k.value=o),title:"API配置",width:"600px"},{footer:t(()=>[l(u,{onClick:e[18]||(e[18]=o=>k.value=!1)},{default:t(()=>e[71]||(e[71]=[r("取消")])),_:1,__:[71]}),l(u,{type:"primary",onClick:b(tl),loading:b(al)},{default:t(()=>e[72]||(e[72]=[r(" 保存 ")])),_:1,__:[72]},8,["onClick","loading"])]),default:t(()=>[l(ne,{model:R.value,"label-width":"120px"},{default:t(()=>[l(V,{label:"API密钥",required:""},{default:t(()=>[l(F,{modelValue:R.value.api_key,"onUpdate:modelValue":e[14]||(e[14]=o=>R.value.api_key=o),type:"password","show-password":"",placeholder:"请输入OpenAI API密钥"},null,8,["modelValue"])]),_:1}),l(V,{label:"Base URL"},{default:t(()=>[l(F,{modelValue:R.value.base_url,"onUpdate:modelValue":e[15]||(e[15]=o=>R.value.base_url=o),placeholder:"https://api.openai.com/v1"},null,8,["modelValue"])]),_:1}),l(V,{label:"模型"},{default:t(()=>[l(F,{modelValue:R.value.model,"onUpdate:modelValue":e[16]||(e[16]=o=>R.value.model=o),placeholder:"gpt-3.5-turbo"},null,8,["modelValue"])]),_:1}),l(V,{label:"最大令牌数"},{default:t(()=>[l(kl,{modelValue:R.value.max_tokens,"onUpdate:modelValue":e[17]||(e[17]=o=>R.value.max_tokens=o),min:100,max:1e4,step:100,placeholder:"2000",style:{width:"100%"}},null,8,["modelValue"]),e[70]||(e[70]=s("div",{class:"form-tip"}," 控制LLM响应的最大长度，一般设置为1000-4000之间 ",-1))]),_:1,__:[70]})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(Q,{modelValue:N.value,"onUpdate:modelValue":e[21]||(e[21]=o=>N.value=o),title:"导入配置",width:"500px"},{footer:t(()=>[l(u,{onClick:e[20]||(e[20]=o=>N.value=!1)},{default:t(()=>e[75]||(e[75]=[r("取消")])),_:1,__:[75]}),l(u,{type:"primary",onClick:b(el),loading:b(ll)},{default:t(()=>e[76]||(e[76]=[r(" 导入 ")])),_:1,__:[76]},8,["onClick","loading"])]),default:t(()=>[l(jl,{ref_key:"uploadRef",ref:D,"auto-upload":!1,limit:1,accept:".json",onChange:yl},{tip:t(()=>e[74]||(e[74]=[s("div",{class:"el-upload__tip"}," 只能上传JSON格式的配置文件 ",-1)])),default:t(()=>[l(u,{type:"primary"},{default:t(()=>e[73]||(e[73]=[r("选择JSON配置文件")])),_:1,__:[73]})]),_:1},512)]),_:1},8,["modelValue"]),l(Q,{modelValue:Z.value,"onUpdate:modelValue":e[23]||(e[23]=o=>Z.value=o),title:H.value?"编辑CSV文件":"添加CSV文件",width:"800px","before-close":$e},{footer:t(()=>[l(u,{onClick:$e},{default:t(()=>e[81]||(e[81]=[r("取消")])),_:1,__:[81]}),l(u,{type:"primary",onClick:fl,loading:ce.value},{default:t(()=>e[82]||(e[82]=[r(" 确定 ")])),_:1,__:[82]},8,["loading"])]),default:t(()=>[l(ne,{ref_key:"csvFormRef",ref:O,model:S.value,rules:ze,"label-width":"100px"},{default:t(()=>[l(V,{label:"文件路径",prop:"path"},{default:t(()=>[l(F,{modelValue:S.value.path,"onUpdate:modelValue":e[22]||(e[22]=o=>S.value.path=o),placeholder:"例如: ./data/campaign/abilities.csv",disabled:H.value},null,8,["modelValue","disabled"]),e[77]||(e[77]=s("div",{class:"form-tip"},"文件路径相对于模组根目录",-1))]),_:1,__:[77]}),l(V,{label:"字段配置",prop:"fields"},{default:t(()=>[s("div",Zl,[(p(!0),P(X,null,Y(S.value.fields,(o,w)=>(p(),P("div",{key:w,class:"field-config-item"},[l(F,{modelValue:o.name,"onUpdate:modelValue":B=>o.name=B,placeholder:"字段名",style:{width:"200px","margin-right":"12px"},onBlur:B=>il(o,w)},null,8,["modelValue","onUpdate:modelValue","onBlur"]),l(x,{modelValue:o.function,"onUpdate:modelValue":B=>o.function=B,placeholder:"选择处理函数",style:{width:"300px","margin-right":"12px"},filterable:""},{default:t(()=>[(p(!0),P(X,null,Y(be("csv"),(B,Je)=>(p(),A(i,{key:Je,label:`${Je} - ${B}`,value:Je},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"]),l(u,{type:"danger",size:"small",onClick:B=>rl(w),disabled:S.value.fields.length<=1},{default:t(()=>e[78]||(e[78]=[r(" 删除 ")])),_:2,__:[78]},1032,["onClick","disabled"])]))),128)),l(u,{type:"primary",onClick:sl,icon:"Plus"},{default:t(()=>e[79]||(e[79]=[r(" 添加字段 ")])),_:1,__:[79]}),e[80]||(e[80]=s("div",{class:"form-tip"},"至少需要配置一个字段",-1))])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),l(Q,{modelValue:ee.value,"onUpdate:modelValue":e[27]||(e[27]=o=>ee.value=o),title:M.value?"编辑JSON文件":"添加JSON文件",width:"600px","before-close":Le},{footer:t(()=>[l(u,{onClick:Le},{default:t(()=>e[85]||(e[85]=[r("取消")])),_:1,__:[85]}),l(u,{type:"primary",onClick:ml,loading:ge.value},{default:t(()=>e[86]||(e[86]=[r(" 确定 ")])),_:1,__:[86]},8,["loading"])]),default:t(()=>[l(ne,{ref_key:"jsonFormRef",ref:T,model:$.value,rules:He,"label-width":"100px"},{default:t(()=>[l(V,{label:"文件路径",prop:"path"},{default:t(()=>[l(F,{modelValue:$.value.path,"onUpdate:modelValue":e[24]||(e[24]=o=>$.value.path=o),placeholder:"例如: ./data/strings/strings.json",disabled:M.value},null,8,["modelValue","disabled"]),e[83]||(e[83]=s("div",{class:"form-tip"},"JSON文件路径相对于模组根目录",-1))]),_:1,__:[83]}),l(V,{label:"处理函数",prop:"extract_function"},{default:t(()=>[l(x,{modelValue:$.value.extract_function,"onUpdate:modelValue":e[25]||(e[25]=o=>$.value.extract_function=o),style:{width:"100%"},filterable:""},{default:t(()=>[(p(!0),P(X,null,Y(be("json"),(o,w)=>(p(),A(i,{key:w,label:`${w} - ${o}`,value:w},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),e[84]||(e[84]=s("div",{class:"form-tip"},"选择适合的JSON解析函数",-1))]),_:1,__:[84]}),l(V,{label:"描述"},{default:t(()=>[l(F,{modelValue:$.value.description,"onUpdate:modelValue":e[26]||(e[26]=o=>$.value.description=o),type:"textarea",placeholder:"文件描述（可选）",rows:3},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),l(Q,{modelValue:le.value,"onUpdate:modelValue":e[33]||(e[33]=o=>le.value=o),title:I.value?"编辑JAR文件":"添加JAR文件",width:"600px","before-close":he},{footer:t(()=>[l(u,{onClick:he},{default:t(()=>e[91]||(e[91]=[r("取消")])),_:1,__:[91]}),l(u,{type:"primary",onClick:_l,loading:_e.value},{default:t(()=>e[92]||(e[92]=[r(" 确定 ")])),_:1,__:[92]},8,["loading"])]),default:t(()=>[l(ne,{ref_key:"jarFormRef",ref:z,model:C.value,rules:Me,"label-width":"100px"},{default:t(()=>[l(V,{label:"文件路径",prop:"path"},{default:t(()=>[l(F,{modelValue:C.value.path,"onUpdate:modelValue":e[28]||(e[28]=o=>C.value.path=o),placeholder:"例如: ./jars/IndEvo.jar",disabled:I.value},null,8,["modelValue","disabled"]),e[87]||(e[87]=s("div",{class:"form-tip"},"JAR文件路径相对于模组根目录",-1))]),_:1,__:[87]}),l(V,{label:"处理函数",prop:"extract_function"},{default:t(()=>[l(x,{modelValue:C.value.extract_function,"onUpdate:modelValue":e[29]||(e[29]=o=>C.value.extract_function=o),style:{width:"100%"},filterable:""},{default:t(()=>[(p(!0),P(X,null,Y(be("jar"),(o,w)=>(p(),A(i,{key:w,label:`${w} - ${o}`,value:w},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),e[88]||(e[88]=s("div",{class:"form-tip"},"选择适合的JAR文件处理函数",-1))]),_:1,__:[88]}),l(V,{label:"描述"},{default:t(()=>[l(F,{modelValue:C.value.description,"onUpdate:modelValue":e[30]||(e[30]=o=>C.value.description=o),type:"textarea",placeholder:"文件描述（可选）",rows:3},null,8,["modelValue"])]),_:1}),l(V,{label:"备份后缀"},{default:t(()=>[l(F,{modelValue:C.value.backup_suffix,"onUpdate:modelValue":e[31]||(e[31]=o=>C.value.backup_suffix=o),placeholder:".backup"},null,8,["modelValue"]),e[89]||(e[89]=s("div",{class:"form-tip"},"原文件备份时的后缀名",-1))]),_:1,__:[89]}),l(V,{label:"输出后缀"},{default:t(()=>[l(F,{modelValue:C.value.output_suffix,"onUpdate:modelValue":e[32]||(e[32]=o=>C.value.output_suffix=o),placeholder:"_translated.jar"},null,8,["modelValue"]),e[90]||(e[90]=s("div",{class:"form-tip"},"翻译后文件的后缀名",-1))]),_:1,__:[90]})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},at=$l(et,[["__scopeId","data-v-eff7950d"]]);export{at as default};
