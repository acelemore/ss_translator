var v=(V,t,f)=>new Promise((x,i)=>{var a=_=>{try{g(f.next(_))}catch(S){i(S)}},w=_=>{try{g(f.throw(_))}catch(S){i(S)}},g=_=>_.done?x(_.value):Promise.resolve(_.value).then(a,w);g((f=f.apply(V,t)).next())});import{_ as Q,u as R,r as C,c as W,s as X,o as Y,v as Z,d as T,e as d,f as r,g as A,h as z,w as l,l as c,j as m,i as o,m as y,x as ee,t as k,y as se,F as te,k as ae,E as n,z as ne,p as b,A as re,b as F}from"./index-B0OZ2IFU.js";const le={class:"files-view"},oe={class:"card-header"},ie={class:"header-actions"},ue={key:0,class:"status-bar"},ce={key:1,class:"status-bar"},de={class:"files-header"},fe={key:0,class:"empty-state"},ge={key:1,class:"files-list"},_e={class:"file-content"},pe={class:"file-info"},ve={class:"file-header"},ye={class:"file-path"},me={class:"file-description"},we={class:"file-details"},he={class:"progress-text"},Te={class:"file-progress"},ke={class:"file-actions"},Se={__name:"FilesView",setup(V){const t=R(),f=C([]),x=C(!1),i=C(!1),a=C(!1),w=C(!1);let g=null;const _=W(()=>{const e=t.translationStatus;return e.running?`æ­£åœ¨ç¿»è¯‘: ${e.current_file} (è¿›åº¦: ${e.progress}%)`:e.status==="interrupted"||a.value?"æ­£åœ¨åœæ­¢ç¿»è¯‘ï¼Œè¯·ç¨å€™...":"ç¿»è¯‘æœåŠ¡å°±ç»ª"}),S=()=>{const e=t.translationStatus;return e.running?"info":e.status==="interrupted"||a.value?"warning":"success"},p=()=>v(null,null,function*(){if(!t.isConfigSelected){n.warning("è¯·å…ˆé€‰æ‹©é…ç½®");return}try{x.value=!0;const e=yield ne.getFiles();e.error?n.error(e.error):f.value=e}catch(e){n.error("åŠ è½½æ–‡ä»¶åˆ—è¡¨å¤±è´¥")}finally{x.value=!1}}),$=e=>v(null,null,function*(){if(!i.value)try{i.value=!0;const s=yield b.startTranslation(e);s.success?(n.success(s.message),yield t.updateTranslationStatus(),yield p(),B()):n.error(s.message)}catch(s){console.error("å¯åŠ¨ç¿»è¯‘å¤±è´¥:",s),n.error("å¯åŠ¨ç¿»è¯‘å¤±è´¥")}finally{i.value=!1}}),U=()=>v(null,null,function*(){if(!i.value)try{i.value=!0;const e=yield b.startTranslation(null);e.success?(n.success("å¼€å§‹ç¿»è¯‘æ‰€æœ‰æ–‡ä»¶"),yield t.updateTranslationStatus(),yield p(),B()):n.error(e.message)}catch(e){console.error("å¯åŠ¨ç¿»è¯‘å¤±è´¥:",e),n.error("å¯åŠ¨ç¿»è¯‘å¤±è´¥")}finally{i.value=!1}}),L=()=>v(null,null,function*(){if(!a.value)try{yield F.confirm("ç¡®å®šè¦åœæ­¢å½“å‰çš„ç¿»è¯‘ä»»åŠ¡å—ï¼Ÿåœæ­¢åå½“å‰æ­£åœ¨ç¿»è¯‘çš„è¿›åº¦å°†è¢«ä¿å­˜ã€‚","ç¡®è®¤åœæ­¢ç¿»è¯‘",{type:"warning",confirmButtonText:"ç¡®å®šåœæ­¢",cancelButtonText:"å–æ¶ˆ"}),a.value=!0;const e=yield b.stopTranslation();e.success?(n.success(e.message),yield t.updateTranslationStatus(),B()):(n.error(e.message),a.value=!1)}catch(e){if(e==="cancel")return;console.error("åœæ­¢ç¿»è¯‘å¤±è´¥:",e),n.error("åœæ­¢ç¿»è¯‘å¤±è´¥"),a.value=!1}}),j=e=>v(null,null,function*(){if(t.isTranslating||a.value){n.warning("ç¿»è¯‘è¿›è¡Œä¸­æˆ–æ­£åœ¨åœæ­¢æ—¶æ— æ³•é‡ç½®è¿›åº¦");return}try{yield F.confirm("é‡ç½®è¿›åº¦ä¼šåˆ é™¤å·²ç¿»è¯‘çš„ä¸´æ—¶æ–‡ä»¶, æ˜¯å¦ç¡®è®¤?","ç¡®è®¤é‡ç½®",{type:"warning",confirmButtonText:"ç¡®å®šé‡ç½®",cancelButtonText:"å–æ¶ˆ"});const s=yield b.resetProgress(e);s.success?(n.success(s.message),yield p()):n.error(s.message)}catch(s){s!=="cancel"&&n.error("é‡ç½®è¿›åº¦å¤±è´¥")}}),D=()=>v(null,null,function*(){if(t.isTranslating||a.value){n.warning("ç¿»è¯‘è¿›è¡Œä¸­æˆ–æ­£åœ¨åœæ­¢æ—¶æ— æ³•é‡ç½®è¿›åº¦");return}if(!w.value)try{yield F.confirm("ç¡®å®šè¦é‡ç½®æ‰€æœ‰æ–‡ä»¶çš„ç¿»è¯‘è¿›åº¦å—ï¼Ÿè¿™å°†åˆ é™¤æ‰€æœ‰å·²ç¿»è¯‘çš„ä¸´æ—¶æ–‡ä»¶ï¼Œæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚","ç¡®è®¤é‡ç½®æ‰€æœ‰æ–‡ä»¶",{type:"warning",confirmButtonText:"ç¡®å®šé‡ç½®æ‰€æœ‰",cancelButtonText:"å–æ¶ˆ",dangerouslyUseHTMLString:!0,message:`<div>
          <p><strong>è­¦å‘Šï¼šæ­¤æ“ä½œå°†ï¼š</strong></p>
          <ul style="text-align: left; margin: 10px 0;">
            <li>æ¸…ç©ºæ‰€æœ‰æ–‡ä»¶çš„ç¿»è¯‘è¿›åº¦</li>
            <li>åˆ é™¤æ‰€æœ‰å·²ç¿»è¯‘çš„ä¸´æ—¶æ–‡ä»¶</li>
            <li>æ— æ³•æ’¤é”€æ­¤æ“ä½œ</li>
          </ul>
          <p>è¯·ç¡®è®¤æ‚¨çœŸçš„è¦é‡ç½®æ‰€æœ‰æ–‡ä»¶çš„è¿›åº¦ã€‚</p>
        </div>`}),w.value=!0;const e=yield b.resetProgress(null);e.success?(n.success("æ‰€æœ‰æ–‡ä»¶è¿›åº¦å·²é‡ç½®"),yield p()):n.error(e.message)}catch(e){e!=="cancel"&&n.error("é‡ç½®æ‰€æœ‰æ–‡ä»¶è¿›åº¦å¤±è´¥")}finally{w.value=!1}}),H=e=>e.total_lines===0?0:Math.round(e.progress/e.total_lines*100),q=e=>{switch(e){case"å·²å®Œæˆ":return"success";case"ç¿»è¯‘ä¸­":return"warning";case"æ— å¯ç¿»è¯‘å†…å®¹":return"success";case"æœªå¼€å§‹":return"info";case"æ­£åœ¨åœæ­¢":return"warning";case"å·²ä¸­æ–­":return"info";default:return"info"}},B=()=>{g||(g=setInterval(()=>v(null,null,function*(){yield t.updateTranslationStatus(),yield p(),t.isTranslating||(I(),a.value=!1)}),3e3))},I=()=>{g&&(clearInterval(g),g=null),a.value=!1};return X(()=>t.isConfigSelected,e=>{e&&f.value.length===0&&p()}),Y(()=>v(null,null,function*(){t.isConfigSelected&&(yield p()),yield t.updateTranslationStatus(),t.isTranslating&&(B(),t.translationStatus.status==="interrupted"&&(a.value=!0))})),Z(()=>{I(),a.value=!1}),(e,s)=>{const h=m("el-button"),M=m("el-icon"),E=m("el-alert"),P=m("el-card"),G=m("el-empty"),N=m("el-tag"),J=m("el-progress"),K=m("el-button-group");return d(),T("div",le,[r(P,{class:"header-card"},{header:l(()=>[o("div",oe,[s[2]||(s[2]=o("span",null,"ğŸ“ æ–‡ä»¶åˆ—è¡¨",-1)),o("div",ie,[r(h,{type:"primary",onClick:U,disabled:!c(t).isConfigSelected||c(t).isTranslating||i.value,loading:i.value},{default:l(()=>s[0]||(s[0]=[y(" å¼€å§‹ç¿»è¯‘æ‰€æœ‰æ–‡ä»¶ ")])),_:1,__:[0]},8,["disabled","loading"]),c(t).isTranslating?(d(),A(h,{key:0,type:"danger",onClick:L,disabled:!c(t).isTranslating||a.value,loading:a.value},{default:l(()=>[a.value?z("",!0):(d(),A(M,{key:0},{default:l(()=>[r(c(ee))]),_:1})),y(" "+k(a.value?"åœæ­¢ä¸­...":"åœæ­¢ç¿»è¯‘"),1)]),_:1},8,["disabled","loading"])):z("",!0),r(h,{onClick:p},{default:l(()=>[r(M,null,{default:l(()=>[r(c(se))]),_:1}),s[1]||(s[1]=y(" åˆ·æ–° "))]),_:1,__:[1]})])])]),default:l(()=>[c(t).currentConfig?(d(),T("div",ue,[r(E,{title:_.value,type:S(),closable:!1,"show-icon":""},null,8,["title","type"])])):(d(),T("div",ce,[r(E,{title:"è¯·å…ˆé€‰æ‹©é…ç½®",type:"warning",closable:!1,"show-icon":""})]))]),_:1}),c(t).isConfigSelected?(d(),A(P,{key:0},{header:l(()=>[o("div",de,[s[4]||(s[4]=o("span",null,"æ–‡ä»¶åˆ—è¡¨",-1)),r(h,{type:"danger",size:"small",onClick:D,disabled:c(t).isTranslating||a.value||w.value,loading:w.value},{default:l(()=>s[3]||(s[3]=[y(" é‡ç½®æ‰€æœ‰æ–‡ä»¶ ")])),_:1,__:[3]},8,["disabled","loading"])])]),default:l(()=>[f.value.length===0?(d(),T("div",fe,[r(G,{description:"æš‚æ— æ–‡ä»¶æ•°æ®"},{default:l(()=>[r(h,{type:"primary",onClick:p},{default:l(()=>s[5]||(s[5]=[y("åˆ·æ–°æ–‡ä»¶åˆ—è¡¨")])),_:1,__:[5]})]),_:1})])):(d(),T("div",ge,[(d(!0),T(te,null,ae(f.value,u=>(d(),T("div",{key:u.path,class:"file-item"},[r(P,{shadow:"hover"},{default:l(()=>[o("div",_e,[o("div",pe,[o("div",ve,[o("h4",ye,k(u.path),1),r(N,{type:q(u.status),class:re({"no-content-tag":u.status==="æ— å¯ç¿»è¯‘å†…å®¹"})},{default:l(()=>[y(k(u.status),1)]),_:2},1032,["type","class"])]),o("p",me,k(u.description),1),o("div",we,[r(N,{size:"small"},{default:l(()=>[y(k(u.type.toUpperCase()),1)]),_:2},1024),o("span",he,k(u.progress)+"/"+k(u.total_lines),1)])]),o("div",Te,[r(J,{percentage:H(u),status:u.completed?"success":void 0,"stroke-width":8},null,8,["percentage","status"])]),o("div",ke,[r(K,null,{default:l(()=>[r(h,{size:"small",onClick:O=>$(u.path),disabled:c(t).isTranslating||i.value,loading:i.value},{default:l(()=>s[6]||(s[6]=[y(" å¼€å§‹ç¿»è¯‘ ")])),_:2,__:[6]},1032,["onClick","disabled","loading"]),r(h,{size:"small",type:"warning",onClick:O=>j(u.path),disabled:c(t).isTranslating||a.value},{default:l(()=>s[7]||(s[7]=[y(" é‡ç½®è¿›åº¦ ")])),_:2,__:[7]},1032,["onClick","disabled"])]),_:2},1024)])])]),_:2},1024)]))),128))]))]),_:1})):z("",!0)])}}},xe=Q(Se,[["__scopeId","data-v-ceac4868"]]);export{xe as default};
