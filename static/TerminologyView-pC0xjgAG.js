var Ve=Object.defineProperty;var J=Object.getOwnPropertySymbols;var ke=Object.prototype.hasOwnProperty,xe=Object.prototype.propertyIsEnumerable;var O=(_,i,s)=>i in _?Ve(_,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):_[i]=s,K=(_,i)=>{for(var s in i||(i={}))ke.call(i,s)&&O(_,s,i[s]);if(J)for(var s of J(i))xe.call(i,s)&&O(_,s,i[s]);return _};var S=(_,i,s)=>new Promise((T,y)=>{var $=f=>{try{w(s.next(f))}catch(b){y(b)}},z=f=>{try{w(s.throw(f))}catch(b){y(b)}},w=f=>f.done?T(f.value):Promise.resolve(f.value).then($,z);w((s=s.apply(_,i)).next())});import{_ as Ce,u as Te,r as m,c as Q,s as Ue,o as Se,d as D,e as c,f as l,w as t,l as De,j as n,m as u,i as v,D as Fe,F as W,k as X,G as $e,g as F,t as I,h as Y,H as C,E as d,b as ze}from"./index-jGo40FSK.js";const Be={class:"terminology-view"},Le={key:0,class:"empty-state"},Ee={key:1},Ne={class:"operations-bar"},Ae={class:"search-section"},Ie={class:"action-buttons"},Pe={class:"pagination-container"},he={key:0,class:"selected-file-info"},je={__name:"TerminologyView",setup(_){const i=Te(),s=m([]),T=m(""),y=m(""),$=m(1),z=m(20),w=m(!1),f=m(!1),b=m(!1),g=m(null),U=m(!1),B=m(!1),L=m(null),r=m({term:"",translation:"",domain:"",notes:""}),q=m(),M=Q(()=>{let a=s.value;if(T.value){const V=T.value.toLowerCase();a=a.filter(k=>k.term.toLowerCase().includes(V)||k.translation&&k.translation.toLowerCase().includes(V)||k.notes&&k.notes.toLowerCase().includes(V))}y.value&&(a=a.filter(V=>V.domain===y.value));const e=($.value-1)*z.value,p=e+z.value;return a.slice(e,p)}),R=Q(()=>{const a=new Set;return s.value.forEach(e=>{e.domain&&a.add(e.domain)}),Array.from(a).sort()}),E=()=>S(null,null,function*(){w.value=!0;try{const a=yield C.getTerminologyList();a.success?s.value=a.terms||[]:d.error(a.message||"加载术语列表失败")}catch(a){console.error("加载术语列表失败:",a),d.error("加载术语列表失败")}finally{w.value=!1}}),Z=a=>{L.value=a,r.value=K({},a),U.value=!0},ee=()=>S(null,null,function*(){try{if(yield q.value.validate(),f.value=!0,L.value)yield C.deleteTerminology(L.value.term),yield C.addTerminology(r.value.term,r.value.translation,r.value.domain||"general",r.value.notes||""),d.success("术语更新成功");else{const a=yield C.addTerminology(r.value.term,r.value.translation,r.value.domain||"general",r.value.notes||"");a.success?d.success("术语添加成功"):d.error(a.message||"术语添加失败")}U.value=!1,te(),yield E()}catch(a){console.error("保存术语失败:",a),d.error("保存失败")}finally{f.value=!1}}),le=a=>S(null,null,function*(){try{yield ze.confirm("确定要删除这个术语吗？","删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const e=yield C.deleteTerminology(a.term);e.success?(d.success("术语删除成功"),yield E()):d.error(e.message||"删除失败")}catch(e){e!=="cancel"&&(console.error("删除术语失败:",e),d.error("删除失败"))}}),te=()=>{r.value={term:"",translation:"",domain:"",notes:""},L.value=null},oe=()=>{B.value=!0},ae=()=>S(null,null,function*(){try{yield C.exportTerminology(),d.success("导出完成")}catch(a){console.error("导出失败:",a),d.error("导出失败")}}),ne=a=>{g.value=a.raw,d.success(`已选择文件: ${a.name}`)},se=()=>S(null,null,function*(){if(!g.value){d.warning("请先选择文件");return}try{b.value=!0;const a=yield C.importTerminology(g.value);a.success?(d.success(a.message),B.value=!1,g.value=null,yield E()):d.error(a.message||"导入失败")}catch(a){console.error("导入失败:",a),d.error("导入失败")}finally{b.value=!1}}),re=a=>a?new Date(a).toLocaleDateString():"-";return Ue(()=>i.isConfigSelected,a=>{a&&s.value.length===0&&E()}),Se(()=>{i.isConfigSelected&&E()}),(a,e)=>{const p=n("el-button"),V=n("el-empty"),k=n("Search"),N=n("el-icon"),P=n("el-input"),j=n("el-option"),G=n("el-select"),ue=n("Plus"),ie=n("Upload"),de=n("Download"),A=n("el-text"),x=n("el-table-column"),me=n("el-tag"),pe=n("el-table"),ce=n("el-pagination"),h=n("el-form-item"),fe=n("el-form"),H=n("el-dialog"),_e=n("upload-filled"),ve=n("el-upload"),ge=n("el-alert"),ye=n("el-card"),we=$e("loading");return c(),D("div",Be,[l(ye,{class:"header-card"},{header:t(()=>e[13]||(e[13]=[v("div",{class:"card-header"},[v("span",null,"📚 专有名词管理"),v("p",null,"管理翻译中的专业术语和固定译名")],-1)])),default:t(()=>[De(i).isConfigSelected?(c(),D("div",Ee,[v("div",Ne,[v("div",Ae,[l(P,{modelValue:T.value,"onUpdate:modelValue":e[1]||(e[1]=o=>T.value=o),placeholder:"搜索术语或译名...",style:{width:"300px"},clearable:""},{prefix:t(()=>[l(N,null,{default:t(()=>[l(k)]),_:1})]),_:1},8,["modelValue"]),l(G,{modelValue:y.value,"onUpdate:modelValue":e[2]||(e[2]=o=>y.value=o),style:{width:"150px","margin-left":"12px"}},{default:t(()=>[l(j,{label:"全部分类",value:""}),(c(!0),D(W,null,X(R.value,o=>(c(),F(j,{key:o,label:o,value:o},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),v("div",Ie,[l(p,{type:"primary",onClick:e[3]||(e[3]=o=>U.value=!0)},{default:t(()=>[l(N,null,{default:t(()=>[l(ue)]),_:1}),e[15]||(e[15]=u(" 添加术语 "))]),_:1,__:[15]}),l(p,{onClick:oe},{default:t(()=>[l(N,null,{default:t(()=>[l(ie)]),_:1}),e[16]||(e[16]=u(" 导入 "))]),_:1,__:[16]}),l(p,{onClick:ae},{default:t(()=>[l(N,null,{default:t(()=>[l(de)]),_:1}),e[17]||(e[17]=u(" 导出 "))]),_:1,__:[17]})])]),Fe((c(),F(pe,{data:M.value,style:{width:"100%"},stripe:""},{default:t(()=>[l(x,{prop:"term",label:"原术语","min-width":"150"},{default:t(o=>[l(A,{type:"primary"},{default:t(()=>[u(I(o.row.term),1)]),_:2},1024)]),_:1}),l(x,{prop:"translation",label:"译名","min-width":"150"},{default:t(o=>[o.row.translation?(c(),F(A,{key:0,type:"primary"},{default:t(()=>[u(I(o.row.translation),1)]),_:2},1024)):(c(),F(A,{key:1,type:"info"},{default:t(()=>e[18]||(e[18]=[u("未翻译")])),_:1,__:[18]}))]),_:1}),l(x,{prop:"domain",label:"分类",width:"120"},{default:t(o=>[o.row.domain?(c(),F(me,{key:0,size:"small"},{default:t(()=>[u(I(o.row.domain),1)]),_:2},1024)):Y("",!0)]),_:1}),l(x,{prop:"notes",label:"说明","min-width":"200","show-overflow-tooltip":""}),l(x,{prop:"frequency",label:"使用频率",width:"100",sortable:""},{default:t(o=>[l(A,null,{default:t(()=>[u(I(o.row.frequency||0),1)]),_:2},1024)]),_:1}),l(x,{prop:"lastUsed",label:"最后使用",width:"120"},{default:t(o=>[l(A,{type:"info",size:"small"},{default:t(()=>[u(I(re(o.row.lastUsed)),1)]),_:2},1024)]),_:1}),l(x,{label:"操作",width:"150",fixed:"right"},{default:t(o=>[l(p,{type:"primary",size:"small",onClick:be=>Z(o.row)},{default:t(()=>e[19]||(e[19]=[u(" 编辑 ")])),_:2,__:[19]},1032,["onClick"]),l(p,{type:"danger",size:"small",onClick:be=>le(o.row)},{default:t(()=>e[20]||(e[20]=[u(" 删除 ")])),_:2,__:[20]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[we,w.value]]),v("div",Pe,[l(ce,{modelValue:$.value,"onUpdate:modelValue":e[4]||(e[4]=o=>$.value=o),"page-size":z.value,total:M.value.length,layout:"prev, pager, next, jumper, total"},null,8,["modelValue","page-size","total"])]),l(H,{modelValue:U.value,"onUpdate:modelValue":e[10]||(e[10]=o=>U.value=o),title:L.value?"编辑术语":"添加术语",width:"600px"},{footer:t(()=>[l(p,{onClick:e[9]||(e[9]=o=>U.value=!1)},{default:t(()=>e[21]||(e[21]=[u("取消")])),_:1,__:[21]}),l(p,{type:"primary",onClick:ee,loading:f.value},{default:t(()=>e[22]||(e[22]=[u("确定")])),_:1,__:[22]},8,["loading"])]),default:t(()=>[l(fe,{model:r.value,"label-width":"80px",ref_key:"termFormRef",ref:q},{default:t(()=>[l(h,{label:"原术语",prop:"term",rules:[{required:!0,message:"请输入原术语"}]},{default:t(()=>[l(P,{modelValue:r.value.term,"onUpdate:modelValue":e[5]||(e[5]=o=>r.value.term=o),placeholder:"请输入原术语"},null,8,["modelValue"])]),_:1}),l(h,{label:"译名",prop:"translation"},{default:t(()=>[l(P,{modelValue:r.value.translation,"onUpdate:modelValue":e[6]||(e[6]=o=>r.value.translation=o),placeholder:"请输入译名"},null,8,["modelValue"])]),_:1}),l(h,{label:"分类",prop:"domain"},{default:t(()=>[l(G,{modelValue:r.value.domain,"onUpdate:modelValue":e[7]||(e[7]=o=>r.value.domain=o),placeholder:"选择或输入分类",filterable:"","allow-create":""},{default:t(()=>[(c(!0),D(W,null,X(R.value,o=>(c(),F(j,{key:o,label:o,value:o},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(h,{label:"说明",prop:"notes"},{default:t(()=>[l(P,{modelValue:r.value.notes,"onUpdate:modelValue":e[8]||(e[8]=o=>r.value.notes=o),type:"textarea",rows:3,placeholder:"术语说明或使用场景"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),l(H,{modelValue:B.value,"onUpdate:modelValue":e[12]||(e[12]=o=>B.value=o),title:"导入术语",width:"500px"},{footer:t(()=>[l(p,{onClick:e[11]||(e[11]=o=>{B.value=!1,g.value=null})},{default:t(()=>e[25]||(e[25]=[u("取消")])),_:1,__:[25]}),l(p,{type:"primary",onClick:se,loading:b.value,disabled:!g.value},{default:t(()=>e[26]||(e[26]=[u(" 导入 ")])),_:1,__:[26]},8,["loading","disabled"])]),default:t(()=>[l(ve,{ref:"uploadRef","auto-upload":!1,"on-change":ne,"show-file-list":!1,accept:".json",drag:""},{tip:t(()=>e[23]||(e[23]=[v("div",{class:"el-upload__tip"}," 只支持 JSON 格式文件 ",-1)])),default:t(()=>[l(N,{class:"el-icon--upload"},{default:t(()=>[l(_e)]),_:1}),e[24]||(e[24]=v("div",{class:"el-upload__text"},[u(" 将文件拖到此处，或"),v("em",null,"点击上传")],-1))]),_:1,__:[24]},512),g.value?(c(),D("div",he,[l(ge,{title:`已选择文件: ${g.value.name}`,type:"success",closable:!1,"show-icon":""},null,8,["title"])])):Y("",!0)]),_:1},8,["modelValue"])])):(c(),D("div",Le,[l(V,{description:"请先选择配置"},{default:t(()=>[l(p,{type:"primary",onClick:e[0]||(e[0]=o=>a.$router.push("/"))},{default:t(()=>e[14]||(e[14]=[u(" 去配置管理 ")])),_:1,__:[14]})]),_:1})]))]),_:1})])}}},Re=Ce(je,[["__scopeId","data-v-4e420ba0"]]);export{Re as default};
